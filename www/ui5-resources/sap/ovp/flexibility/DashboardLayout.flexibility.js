sap.ui.define(["sap/ovp/changeHandler/HideCardContainer","sap/ovp/changeHandler/UnhideCardContainer","sap/ovp/changeHandler/UnhideControl","sap/ui/dt/OverlayRegistry","sap/ui/core/ComponentContainer","sap/m/MessageToast","sap/ovp/cards/rta/SettingsDialogConstants"],function(H,U,a,O,C,M,S){"use strict";return{"moveControls":{"changeHandler":"default","layers":{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"unhideControl":a,"unhideCardContainer":U,"hideCardContainer":H,"editCardSettings":{changeHandler:{applyChange:function(c,o,p){var m=p.appComponent.getRootControl(),b=m.getController(),d=c.getContent(),e=d.newAppDescriptor,f=m.byId(e.id),g=b.getLayout(),l=g.getDashboardLayoutModel(),L=g.getDashboardLayoutUtil(),h=l.getCardById(e.id),i=L.calculateCardProperties(e.id),n=e.settings.defaultSpan&&e.settings.defaultSpan.rows,N=e.settings.defaultSpan&&e.settings.defaultSpan.cols,j=l.getColCount()+1,k=[],F=false;c.setRevertData(d.oldAppDescriptor);if(f){if(e.settings.tabs){var D=e.settings.selectedKey;if(!D||D<1){D=1;}S.tabFields.forEach(function(r){delete e.settings[r];var v=e.settings.tabs[D-1][r];if(v){e.settings[r]=v;}});}if(typeof n==='number'){if(n===0){h.dashboardLayout.showOnlyHeader=true;n=Math.ceil((i.headerHeight+2*L.CARD_BORDER_PX)/L.getRowHeightPx());}else{h.dashboardLayout.showOnlyHeader=false;if(e.template==='sap.ovp.cards.list'||e.template==='sap.ovp.cards.table'){h.dashboardLayout.noOfItems=n;}}}if(N){if(h.dashboardLayout.column+N>j){h.dashboardLayout.maxColSpan=N;N=j-h.dashboardLayout.column;}F=true;}if(F){l._arrangeCards(h,{row:n,column:N},'resize',k);l._removeSpaceBeforeCard(k);L._positionCards(l.aCards);F=false;}var q=f.getComponentInstance();q.destroy();}b.recreateRTAClonedCard(e);return true;},revertChange:function(c,o,p){var m=p.appComponent.getRootControl(),b=m.getController(),d=c.getRevertData(),e=m.byId(d.id),f=b.getLayout(),l=f.getDashboardLayoutModel(),L=f.getDashboardLayoutUtil(),g=l.getCardById(d.id),i=d.settings.defaultSpan&&d.settings.defaultSpan.rowSpan,h=d.settings.defaultSpan&&d.settings.defaultSpan.colSpan,s=d.settings.defaultSpan&&d.settings.defaultSpan.showOnlyHeader,j=[];if(e){g.dashboardLayout.rowSpan=i;g.dashboardLayout.colSpan=h;g.dashboardLayout.showOnlyHeader=s;l._arrangeCards(g,{row:i,column:h},'resize',j);l._removeSpaceBeforeCard(j);L._positionCards(l.aCards);var k=e.getComponentInstance();k.destroy();}b.recreateRTAClonedCard(d);c.resetRevertData();return true;},completeChangeContent:function(c,s,p){return;}},layers:{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"newCardSettings":{changeHandler:{applyChange:function(c,o,p){var m=p.appComponent.getRootControl(),b=m.getController(),d=c.getContent();c.setRevertData(d.id);var n=new C(m.getId()+"--"+d.id),u=b.getUIModel(),e=u.getProperty("/cards"),f=b.getLayout(),l=f.getDashboardLayoutUtil(),L=f.getDashboardLayoutModel(),N=(d.id.indexOf("newStaticLinkListCard")!==-1);d.settings.baseUrl=b._getBaseUrl();if(N){d.settings.newCard=true;L._setCardSpanFromDefault(d);d.dashboardLayout.row=1;d.dashboardLayout.column=1;}else{d.settings.cloneCard=true;}var I=-1,i;for(i=0;i<e.length;i++){if(d.id.lastIndexOf("customer."+e[i].id,0)===0){I=i;var g=L.getCardById(e[i].id);d.dashboardLayout=jQuery.extend(true,{},g.dashboardLayout);var h=d.dashboardLayout.column+d.dashboardLayout.colSpan;d.dashboardLayout.column=h<L.getColCount()?h:1;break;}}e.splice(I+1,0,d);l.getCards().splice(I+1,0,d);u.setProperty("/cards",e);f.insertContent(n,I+1);setTimeout(function(){var j=O.getOverlay(n);j.setSelected(true);j.focus();var r=sap.ui.getCore().getLibraryResourceBundle("sap.ovp"),s=(N)?r.getText("OVP_KEYUSER_TOAST_MESSAGE_FOR_NEW"):r.getText("OVP_KEYUSER_TOAST_MESSAGE_FOR_CLONE");M.show(s,{duration:10000});},0);b.recreateRTAClonedCard(d);return true;},revertChange:function(c,o,p){var m=p.appComponent.getRootControl(),b=m.getController(),s=c.getRevertData();var d=m.byId(s),u=b.getUIModel(),e=u.getProperty("/cards"),f=b.getLayout(),l=f.getDashboardLayoutUtil(),L=f.getDashboardLayoutModel(),g=l.getCards();var I=-1,i,j,h=-1;for(i=0;i<e.length;i++){if(s===e[i].id){I=i;break;}}e.splice(I,1);for(j=0;j<g.length;j++){if(s===g[j].id){h=j;break;}}g.splice(h,1);L._removeSpaceBeforeCard();u.setProperty("/cards",e);if(d){var k=d.getComponentInstance();k.destroy();}f.removeContent(I);d.destroy();c.resetRevertData();return true;},completeChangeContent:function(c,s,p){return;}},layers:{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"dragAndDropUI":{changeHandler:{applyChange:function(c,p,P){var m=P.appComponent.getRootControl().getController(),o=c.getContent(),b=m.getLayout(),l=b.getDashboardLayoutUtil(),L=b.getDashboardLayoutModel(),d=L.getCardById(o.cardId),s='C'+L.getColCount(),e=[];c.setRevertData(o);L._arrangeCards(d,{row:o.dashboardLayout[s].row,column:o.dashboardLayout[s].column},'drag',e);L._removeSpaceBeforeCard(e);l._positionCards(L.aCards);return true;},revertChange:function(c,o,p){var m=p.appComponent.getRootControl().getController(),b=c.getContent(),d=m.getLayout(),l=d.getDashboardLayoutUtil(),L=d.getDashboardLayoutModel(),e=L.getCardById(b.cardId),s='C'+L.getColCount(),f=[];L._arrangeCards(e,{row:b.dashboardLayout[s].oldRow,column:b.dashboardLayout[s].oldColumn},'drag',f);if(b.dashboardLayout[s].oldColSpan){L._arrangeCards(e,{row:b.dashboardLayout[s].rowSpan,column:b.dashboardLayout[s].oldColSpan},'resize',f);}L._removeSpaceBeforeCard(f);l._positionCards(L.aCards);c.resetRevertData();return true;},completeChangeContent:function(c,s,p){return;}},layers:{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"manageCardsForDashboardLayout":{changeHandler:{applyChange:function(c,p,P){var m=P.appComponent.getRootControl().getController();m.storeIncomingDeltaChanges(c.getContent());return true;},completeChangeContent:function(c,s,p){c.setContent(s.content);return;}},layers:{"USER":true}},"viewSwitch":{changeHandler:{applyChange:function(c,p,P){var m=P.appComponent.getRootControl().getController();m.appendIncomingDeltaChange(c);return true;},completeChangeContent:function(c,s,p){return;}},layers:{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"visibility":{changeHandler:{applyChange:function(c,p,P){var m=P.appComponent.getRootControl().getController();m.appendIncomingDeltaChange(c);return true;},completeChangeContent:function(c,s,p){return;}},layers:{"USER":true}},"dragOrResize":{changeHandler:{applyChange:function(c,p,P){var m=P.appComponent.getRootControl().getController();m.appendIncomingDeltaChange(c);return true;},completeChangeContent:function(c,s,p){return;}},layers:{"CUSTOMER_BASE":true,"CUSTOMER":true,"USER":true}},"manageCardsForEasyScanLayout":{changeHandler:{applyChange:function(c,p,P){return true;},completeChangeContent:function(c,s,p){c.setContent(s.content);return;}},layers:{"USER":true}}};},true);
