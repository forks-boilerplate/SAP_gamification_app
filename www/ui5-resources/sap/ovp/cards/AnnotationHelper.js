sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/core/ValueState","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/vbm/library","sap/ui/generic/app/navigation/service/SelectionVariant"],function(q,N,D,C,O,V,F,a,o,b,S){"use strict";var f={count:0};var c={};var d={};var e={};var g={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function h(i,j){var k=j.Longitude.Path;var X2=j.Latitude.Path;return"{path:'"+k+"'}; {path:'"+X2+"'}"+";0";}h.requiresIContext=true;function l(i,j){return"{path:'"+j.CountryCode.Path+"'}";}l.requiresIContext=true;function m(i,j){var k=j.Criticality.Path;return"{path:'"+k+"', formatter: 'sap.ovp.cards.AnnotationHelper.getCriticalityStateFromValue' }";}m.requiresIContext=true;function n(i){var j;switch(i){case"0":j=b.SemanticType.Default;break;case"1":j=b.SemanticType.Error;break;case"2":j=b.SemanticType.Warning;break;case"3":j=b.SemanticType.Success;break;default:j=b.SemanticType.None;break;}return j;}function p(i,j){var k=i.getSetting('ovpCardProperties');var X2=k.getProperty('/showLabelText');if(X2==="true"){var Y2=j.Address[0];if(typeof Y2.country!=="undefined"){return"{path:'"+Y2.country.Path+"'}";}else if(typeof Y2.locality!=="undefined"){return"{path:'"+Y2.locality.Path+"'}";}else if(typeof Y2.street!=="undefined"){return"{path:'"+Y2.street.Path+"'}";}else if(typeof Y2.code!=="undefined"){return"{path:'"+Y2.code.Path+"'}";}}else{return null;}}p.requiresIContext=true;function r(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var X2=k&&k.getProperty("/metaModel");var Y2=k&&k.getProperty("/entityType");if(!X2||!Y2){return"";}var Z2;if(j.Value){Z2=j.Value.Path;}if(j.Target){var $2=K(Y2.$path,j);var _2=$2&&X2.getProperty($2);Z2=_2&&_2.Value.Path;}if(!Z2||!Z2.length>0||Z2===" "){return"";}var a3=X2.getODataProperty(Y2,Z2);if(!a3){return"";}var b3=a3["sap:label"]||(a3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return b3;}r.requiresIContext=true;function s(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function t(i,k,j){if(i.getSetting){var X2=i.getSetting("_ovpCache");if(X2){X2[k]=j;}}}function u(i,j){if(!f[j]){f[j]=0;}f[j]++;var k=j+f[j];f[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function v(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var X2=i.EnumMember;if(x(X2,'Negative')){k=j.Negative;}else if(x(X2,'Critical')){k=j.Critical;}else if(x(X2,'Positive')){k=j.Positive;}}}return k;}function w(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function x(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function y(i,j,k,X2,Y2,Z2,$2){var _2={};_2.EnumMember="None";var a3=Number.NEGATIVE_INFINITY;var b3=Number.POSITIVE_INFINITY;if(!Y2&&k){Y2=k;}if(!Z2&&X2){Z2=X2;}if(!k){k=a3;}if(!X2){X2=b3;}if(i!==undefined){i=Number(i);if(x(j,"Minimize")||x(j,"Minimizing")){if(Z2&&X2){if(i<=parseFloat(Z2)){_2.EnumMember="Positive";}else if(i>parseFloat(X2)){_2.EnumMember="Negative";}else{_2.EnumMember="Critical";}}}else if(x(j,"Maximize")||x(j,"Maximizing")){if(Y2&&k){if(i>=parseFloat(Y2)){_2.EnumMember="Positive";}else if(i<parseFloat(k)){_2.EnumMember="Negative";}else{_2.EnumMember="Critical";}}}else if(x(j,"Target")){if(Z2&&X2&&Y2&&k){if(i>=parseFloat(Y2)&&i<=parseFloat(Z2)){_2.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(X2)){_2.EnumMember="Negative";}else{_2.EnumMember="Critical";}}}}return v(_2,$2);}function z(i,j,k,X2){if(!i||!j){return;}i=Number(i);if(!X2&&(i-j>=0)){return"sap-icon://trend-up";}if(!k&&(i-j<=0)){return"sap-icon://trend-down";}if(j&&X2&&(i-j>=X2)){return"sap-icon://trend-up";}if(j&&k&&(i-j<=k)){return"sap-icon://trend-down";}}function B(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var X2=s(i,k);if(!X2){var Y2=E(i,j);var Z2=Y2.map(function($2){return $2.Value.Path;});Z2=Z2.filter(function($2){return!!$2;});X2=j.filter(function($2){if($2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&Z2.indexOf($2.Value.Path)===-1){return true;}return false;});X2=M(X2);t(i,k,X2);}return X2;}B.requiresIContext=true;function E(j,k,X2){var Y2=j.getPath(0)+"-DataPoints-Sorted";var Z2=s(j,Y2);if(!Z2){if(X2){Z2=k.filter(H);}else{Z2=k.filter(G);}Z2=M(Z2);var $2;for(var i=0;i<Z2.length;i++){$2=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);Z2[i]=j.getModel(0).getProperty(K($2,Z2[i]));$2="";}t(j,Y2,Z2);}return Z2;}E.requiresIContext=true;function G(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function H(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function J(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function K(i,j){if(i&&!x(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function L(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function M(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var X2=i.slice(j,i.length);return P(M(k),M(X2));}function P(i,j){var k=[];while(i.length&&j.length){var X2=L(i[0]),Y2=L(j[0]);if(X2<=Y2){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function Q(i,j,k){var X2=B(i,j)[k];if(X2){return $(i,X2);}return"";}function R(i,j,k){var X2=B(i,j)[k];return r(i,X2);}function U(i,j,k){var X2=E(i,j)[k];if(X2&&X2.Title){return X2.Title.String;}return"";}function W(i,j,k){var X2=j.filter(G);X2=M(X2);if(!X2||!X2.length||!X2.length>0){return"";}return r(i,X2[0]);}function X(i,j,k,X2){var Y2=E(i,j)[k];if(!Y2){return"";}var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/entityType");var _2=Z2.getProperty("/metaModel");return _(i,Y2,$2,_2,X2);}function Y(i,j,k){var X2=E(i,j)[k];if(X2&&X2.Criticality){return true;}}function Z(i,j,k){var X2=E(i,j)[k];var Y2=X2.Criticality.Path;return"{path:'"+Y2+"'}";}function _(i,j,k,X2,Y2){if(!j||!j.Value){return"";}var Z2=i.getSetting('ovpCardProperties');var $2=false;if(Z2){var _2=Z2.getProperty("/ignoreSapText");$2=_2==undefined?$2:_2;}var a3=X2.getODataProperty(k,j.Value.Path);var b3=false;if($2==true){if(a3&&(a3["com.sap.vocabularies.Analytics.v1.Measure"]||a3["sap:aggregation-role"]=="measure")){b3=true;}}if(!b3&&a3){var c3;if(a3["com.sap.vocabularies.Common.v1.Text"]){c3=a3["com.sap.vocabularies.Common.v1.Text"].String?a3["com.sap.vocabularies.Common.v1.Text"].String:a3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(a3["sap:text"]){c3=a3["sap:text"];}if(c3){a3=X2.getODataProperty(k,c3);j={Value:{Path:a3.name}};}}return $(i,j,Y2);}function $(i,j,k,X2){if(j.Value.Apply){return O.format(i,j.Value);}var Y2=i.getSetting('ovpCardProperties');var Z2=Y2.getProperty("/entityType");var $2=Y2.getProperty("/metaModel");return b1(i,j,Z2,$2,k,X2);}$.requiresIContext=true;function a1(i,j,k,X2){if((!k)||(typeof X2!=='string')){return X2;}var Y2=k[A.TEXT];if(!Y2){return X2;}var Z2,$2;Z2=k[A.TEXT_ARRANGEMENT];$2=Z2&&Z2.EnumMember;if(!$2){Z2=Y2&&Y2[A.TEXT_ARRANGEMENT];$2=Z2&&Z2.EnumMember;}if(!$2){Z2=j&&j[A.TEXT_ARRANGEMENT];$2=Z2&&Z2.EnumMember;}if(!$2){return X2;}var _2=O.format(i,Y2);if(!_2||_2===" "){return X2;}var a3;switch($2){case T.TEXT_FIRST:a3=_2+" ("+X2+")";break;case T.TEXT_LAST:a3=X2+" ("+_2+")";break;case T.TEXT_ONLY:a3=_2;break;case T.TEXT_SEPARATE:a3=X2+" ("+_2+")";break;default:a3=X2;break;}return a3;}function b1(i,j,k,X2,Y2,Z2,$2){if(j.Value.Apply){return O.format(i,j.Value);}var _2=X2.getODataProperty(k,j.Value.Path),a3="",b3;var c3=i.getSetting("ovpCardProperties");var d3=c3&&c3.getProperty("/contentFragment");if(!Z2){if(j.Value.Path.split("/").length>1){_2=i1(X2,k,j.Value.Path);}if(!_2){return"";}if(_2["type"]==='Edm.DateTime'||_2["type"]==='Edm.DateTimeOffset'){var e3=c3&&c3.getProperty("/showDateInRelativeFormat");b3=f1("dateFormatFunction",e3);a3=c1([j.Value.Path?j.Value.Path:_2.name],b3);}else if((j.ValueFormat&&j.ValueFormat.NumberOfFractionalDigits)||_2["scale"]){var f3=(j.ValueFormat&&j.ValueFormat.NumberOfFractionalDigits)?j.ValueFormat.NumberOfFractionalDigits.Int:0,g3;if(_2["Org.OData.Measures.V1.ISOCurrency"]){g3=_2["Org.OData.Measures.V1.ISOCurrency"].Path?_2["Org.OData.Measures.V1.ISOCurrency"].Path:_2["Org.OData.Measures.V1.ISOCurrency"].String;}else if(_2["Org.OData.Measures.V1.Unit"]){g3=_2["Org.OData.Measures.V1.Unit"].Path?_2["Org.OData.Measures.V1.Unit"].Path:_2["Org.OData.Measures.V1.Unit"].String;}else if(_2["sap:unit"]){g3=_2["sap:unit"];}var h3=g3?X2.getODataProperty(k,g3):null,i3=[j.Value.Path?j.Value.Path:_2.name];if(f3>2){f3=2;}if(_2["Org.OData.Measures.V1.ISOCurrency"]){var j3=_2["Org.OData.Measures.V1.ISOCurrency"];if(j3.Path){b3=g1(f3);i3.push(j3.Path);}else if(j3.String){b3=g1(f3,j3.String);}}else if(h3&&(h3["Org.OData.Measures.V1.ISOCurrency"]||h3["sap:semantics"]==="currency-code")){b3=g1(f3);i3.push(g3);}else{b3=d1(f3);}a3=c1(i3,b3);}else{if($2){a3=O.simplePath(i,j.Value);}else{a3=O.format(i,j.Value);}}if(d3&&(d3==="sap.ovp.cards.table.Table"||d3==="sap.ovp.cards.list.List")){a3=a1(i,k,_2,a3);}if(_2["Org.OData.Measures.V1.Unit"]){var k3=_2["Org.OData.Measures.V1.Unit"];if(k3.Path){a3+=(" "+c1([k3.Path]));}else if(k3.String){if(k3.String!=="%"){a3+=" ";}a3+=k3.String;}}}if(!Y2){if(_2["Org.OData.Measures.V1.ISOCurrency"]){var j3=_2["Org.OData.Measures.V1.ISOCurrency"];if(j3.Path){a3+=(" "+c1([j3.Path]));}else if(j3.String){a3+=(" "+j3.String);}}}if(a3[0]===" "){a3=a3.substring(1);}return a3;}function c1(j,k){var X2="",Y2=j.length;if(Y2>1){X2="{parts:[";for(var i=0;i<Y2;i++){X2+=("{path: '"+j[i]+"'}"+((i===Y2-1)?"]":", "));}}else{X2="{path: '"+j[0]+"'";}X2+=(k?(", formatter: '"+k+"'"):"")+"}";return X2;}function d1(i){var j="formatNumberCalculation"+i;if(!c[j]){c[j]=e1(Number(i));}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+j;}function e1(i){return function(j){var k=N.getFloatInstance({style:'short',showMeasure:false,minFractionDigits:i,maxFractionDigits:i});return k.format(Number(j));};}function f1(i,j){var k={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){k={'style':'medium'};}if(!d[i]){d[i]=function(X2){var Y2=D.getInstance(k);if(!X2){X2="";return X2;}return Y2.format(new Date(X2));};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function g1(i,j){var k="formatCurrencyCalculation"+(j?j+i:i);if(!e[k]){e[k]=h1(i,j);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+k;}function h1(i,j){return function(k,X2){var Y2="";var Z2=N.getCurrencyInstance({style:'short',showMeasure:false,minFractionDigits:i,maxFractionDigits:i});if(X2){Y2=Z2.format(k,X2);}else{Y2=j?Z2.format(k,j):Z2.format(k);}return Y2;};}function i1(j,k,X2){var Y2=X2.split("/");if(Y2.length>1){for(var i=0;i<(Y2.length-1);i++){var Z2=j.getODataAssociationEnd(k,Y2[i]);if(Z2){k=j.getODataEntityType(Z2.type);}}return j.getODataProperty(k,Y2[Y2.length-1]);}}function j1(i,j,k){var X2=E(i,j);var Y2=g.StateValues;var Z2=X2[k];if(!Z2){return Y2.None;}if(Z2.Criticality){return n1(i,Z2,Y2);}return p1(i,Z2,Y2);}function k1(i,j,k){var X2=E(i,j);if(X2&&X2.length){var Y2=X2[0];if(Y2&&(Y2.Criticality||Y2.CriticalityCalculation)){return true;}}return false;}function l1(i,j,k){if(k1(i,j,k)){return'';}return'#5cbae6';}l1.requiresIContext=true;function m1(i,j,k){var X2=E(i,j),Y2="None",Z2=g.ColorValues;if(X2.length>k){var $2=X2[k];if($2&&$2.Criticality){Y2=n1(i,$2,Z2);}else{Y2=p1(i,$2,Z2);}}return Y2;}function n1(i,j,k){var X2=V.None;var Y2;var Z2=j.Criticality;if(Z2){Y2="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(Z2.Path){var $2='$'+O.simplePath(i,Z2);X2=q.sap.formatMessage(Y2,$2);}else if(Z2.EnumMember){var _2="'"+Z2.EnumMember+"'";X2=q.sap.formatMessage(Y2,_2);}else{q.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}}else{q.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}return X2;}function o1(i,j,k){var X2=E(i,j);var Y2="None";if(X2.length>k){var Z2=X2[k];if(Z2&&Z2.Criticality&&Z2.Criticality.Path){Y2=Z(i,j,k);}else{Y2=p1(i,Z2,g.StateValues);Y2=w(Y2);}}return Y2;}function p1(i,j,k){var X2=k.None;if(j.Criticality){X2=v(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){X2=q1(i,j,k);}return X2;}function q1(i,j,k){var X2=F1(j.Value);var Y2=j.CriticalityCalculation.ImprovementDirection.EnumMember;var Z2=F1(j.CriticalityCalculation.DeviationRangeLowValue);var $2=F1(j.CriticalityCalculation.DeviationRangeHighValue);var _2=F1(j.CriticalityCalculation.ToleranceRangeLowValue);var a3=F1(j.CriticalityCalculation.ToleranceRangeHighValue);var b3=r1(Z2);var c3=r1($2);var d3=r1(_2);var e3=r1(a3);var f3="parts: ["+X2;f3+=b3?","+Z2:"";f3+=c3?","+$2:"";f3+=d3?","+_2:"";f3+=e3?","+a3:"";f3+="]";var g3=function(){var i3=1;return y(arguments[0],Y2,b3?arguments[i3++]:Z2,c3?arguments[i3++]:$2,d3?arguments[i3++]:_2,e3?arguments[i3++]:a3,k);};var h3=u(g3,"formatCriticalityCalculation");return"{"+f3+", formatter: '"+h3+"'}";}function r1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function s1(j,k,X2){var Y2="";var Z2=X2.split("/");if(Z2.length>1){for(var i=0;i<(Z2.length-1);i++){var $2=j.getODataAssociationEnd(k,Z2[i]);if($2){k=j.getODataEntityType($2.type);if(Y2){Y2=Y2+"/";}Y2=Y2+Z2[i];}else{return Y2;}}}return Y2;}function t1(i,j){var k=i.getSetting('ovpCardProperties');var X2=k.getProperty("/addODataSelect");var Y2=k.getProperty("/metaModel");var Z2=Y2.getODataEntityType(j.entityType);var $2=Z2[k.getProperty('/selectionAnnotationPath')];var _2=Z2[k.getProperty('/presentationAnnotationPath')];var a3="/"+j.name;var b3=Array.prototype.slice.call(arguments,2);var c3=i.getSetting('ovpCardProperties'),d3=c3.getProperty('/parameters');if($2||!!d3){if(($2&&$2.Parameters&&$2.Parameters.length>0)||!!d3){a3=x2(i.getSetting('dataModel'),j,$2,d3);}}if(k.getProperty("/cardLayout")&&k.getProperty("/cardLayout/noOfItems")){var e3="{path: '"+a3+"', length: "+ +(k.getProperty("/cardLayout/noOfItems"));}else{var e3="{path: '"+a3+"', length: "+G1(k);}var f3=[];if(X2){f3=v1(i,Y2,Z2,b3);}var g3=u1(Y2,Z2,b3);if(f3.length>0||g3.length>0){e3=e3+", parameters: {";if(f3.length>0){e3=e3+"select: '"+f3.join(',')+"'";}if(g3.length>0){if(f3.length>0){e3=e3+", ";}e3=e3+"expand: '"+g3.join(',')+"'";}e3=e3+"}";}var h3=x1(k,_2);if(h3.length>0){e3=e3+", sorter:"+JSON.stringify(h3);}var i3=B1(k,$2);if(i3.length>0){e3=e3+", filters:"+JSON.stringify(i3);}e3=e3+"}";return e3;}t1.requiresIContext=true;function u1(k,X2,Y2){var Z2=[];var $2,_2,a3,b3;for(var i=0;i<Y2.length;i++){if(!Y2[i]){continue;}$2=X2.$path+"/"+Y2[i];_2=k.createBindingContext($2);a3=_2.getObject();a3=a3?a3:[];for(var j=0;j<a3.length;j++){if(a3[j].Value&&a3[j].Value.Path){b3=s1(k,X2,a3[j].Value.Path);if(b3&&Z2.indexOf(b3)===-1){Z2.push(b3);}}}}return Z2;}function v1(X2,Y2,Z2,$2){var _2=[];var a3,b3,c3;for(var i=0;i<$2.length;i++){if(!$2[i]){continue;}a3=Z2.$path+"/"+$2[i];b3=Y2.createBindingContext(a3);var d3={};if(X2&&X2.bDummyContext){q.extend(d3,X2,b3,true);}else{d3=X2;}c3=b3.getObject();if(!c3){c3=[];}else if(q.isPlainObject(c3)){if(c3.Data){c3=c3.Data;}else{c3=[];}}var e3;var f3;var g3;var h3;for(var j=0;j<c3.length;j++){f3=[];e3=c3[j];g3="";h3=e3.RecordType;if(h3==="com.sap.vocabularies.UI.v1.DataField"){g3=b1(d3,e3,Z2,Y2,undefined,undefined,true);}else if(h3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var i3=K(Z2.$path,e3);g3=_(d3,Y2.getProperty(i3),Z2,Y2);var j3=J(Y2.getProperty(i3));if(j3&&j3.length>0){g3+=j3;}}else if(h3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&e3.Url){var k3;if(!e3.Url.UrlRef){k3=O.format(d3,e3.Url);}if(k3&&k3.substring(0,2)==="{="){g3=k3;}}if(g3){var l3=O.simplePath(d3,e3.Value);if(g3.indexOf("(")<0&&g3!==l3){g3=[].concat(l3,g3).join(" ");}f3=w1(g3);}if(f3&&f3.length>0){var m3;for(var k=0;k<f3.length;k++){m3=f3[k];if(!_2[m3]){_2[m3]=true;var n3=C.getUnitColumn(m3,Z2);if(n3&&n3!==m3){_2[n3]=true;}var o3=V2(Y2,Z2,m3);if(o3&&o3!==m3){_2[o3]=true;}}}}}}return Object.keys(_2);}function w1(j){var i,k=0,X2=j.length,Y2="",Z2;for(i=0;i<X2;i++){Z2=j.charAt(i);if(!Z2){return;}switch(Z2){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}Y2+=Z2;}j=Y2;var $2=/\${([a-zA-Z0-9\_|\/]*)/g;var _2=/[^[{]*[a-zA-Z0-9\_]/g;var a3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var b3,c3,d3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){b3=$2;c3=1;}else if(j.indexOf("path")!==-1){var e3=_2.exec(j);while(e3){if(e3[0].indexOf("path")===-1&&e3[0].indexOf("@i18n")!==0){d3.push(e3[0]);}e3=_2.exec(j);}b3=a3;c3=1;}else{b3=_2;c3=0;}var f3=b3.exec(j);while(f3){if(f3[c3]&&f3[c3].indexOf("@i18n")!==0){d3.push(f3[c3]);}f3=b3.exec(j);}return d3;}function x1(j,k){var X2=[];var Y2,Z2;var $2=j.getProperty("/sortBy");if($2){var _2=j.getProperty('/sortOrder');if(_2&&_2.toLowerCase()!=='descending'){Z2=false;}else{Z2=true;}Y2={path:$2,descending:Z2};X2.push(Y2);}var a3=k&&k.SortOrder||undefined;var b3,$2;if(a3){for(var i=0;i<a3.length;i++){b3=a3[i];$2=b3.Property.PropertyPath;Z2=C1(b3.Descending,true);Y2={path:$2,descending:Z2};X2.push(Y2);}}return X2;}function y1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:B1(i,k),parameters:A1(k)};}function z1(j){if(!j){return;}var k=j.getProperty('/entityType');var X2=k[j.getProperty('/presentationAnnotationPath')];var Y2=x1(j,X2);var Z2=[];var i,$2=Y2.length;for(i=0;i<$2;i++){if(!Y2[i].path){continue;}Z2.push({Property:Y2[i].path,Descending:Y2[i].descending});}if(Z2.length>0){return{SortOrder:Z2};}}function A1(j){var k,X2=[];if(!j||!j.Parameters){return X2;}var Y2=j.Parameters.length;for(var i=0;i<Y2;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){q.sap.log.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}X2[X2.length]={path:k.PropertyName.PropertyPath,value:E1(k.PropertyValue)};}return X2;}function B1(k,X2){var Y2=[];var Z2;var $2=k.getProperty("/filters");if($2){Y2=Y2.concat($2);}if(X2&&X2.SelectOptions){Z2=X2.SelectOptions;}else{Z2=X2;}var _2,a3,b3;if(Z2){for(var i=0;i<Z2.length;i++){_2=Z2[i];a3=_2.PropertyName.PropertyPath;for(var j=0;j<_2.Ranges.length;j++){b3=_2.Ranges[j];if(b3.Sign.EnumMember){var c3={path:a3,operator:b3.Option.EnumMember.split("/")[1],value1:E1(b3.Low),value2:E1(b3.High),sign:b3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(c3.sign==="E"&&c3.operator!==F.EQ){q.sap.log.error("Exclude sign is supported only with EQ operator");continue;}if(c3.sign==="E"&&c3.operator===F.EQ){c3.operator=F.NE;c3.sign="I";}if(c3.operator==="CP"&&c3.sign==="I"){var d3=F.Contains;var e3=c3.value1;if(e3){var f3=e3.indexOf('*');var g3=e3.lastIndexOf('*');if(f3>-1){if((f3===0)&&(g3!==(e3.length-1))){d3=F.EndsWith;e3=e3.substring(1,e3.length);}else if((f3!==0)&&(g3===(e3.length-1))){d3=F.StartsWith;e3=e3.substring(0,e3.length-1);}else{e3=e3.substring(1,e3.length-1);}}}c3.operator=d3;c3.value1=e3;}Y2.push(c3);}}}}return Y2;}function C1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function D1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function E1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=C1(i);}else{j=D1(i);}}return j;}function F1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return E1(i);}}else{return"";}}function G1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var X2=i.getProperty('/listFlavor');var Y2;var Z2="desktop";if(a.system.phone){Z2="phone";}else if(a.system.tablet){Z2="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(X2=="bar"){Y2=I["List_extended_bar"];}else{Y2=I["List_extended"];}}else if(X2=="bar"){Y2=I["List_condensed_bar"];}else{Y2=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){Y2=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){Y2=I["Stack_complex"];}else{Y2=I["Stack_simple"];}}if(Y2){return Y2[Z2];}return 5;}function H1(i){var j=i.getObject();var k=E(i,j,true);var X2=k.map(function(Y2){if(Y2&&Y2.Value&&Y2.Value.Path){return Y2.Value.Path;}else if(Y2&&Y2.fn&&Y2.fn.Path){return Y2.fn.Path;}});j.filter(function(Y2,Z2){if(Y2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&X2.indexOf(Y2.Value.Path)>-1){j.splice(Z2,1);}});}H1.requiresIContext=true;function I1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}I1.requiresIContext=true;function J1(i,j){var k=E(i,j);return k.length;}J1.requiresIContext=true;function K1(i,j){return M1(i,j,0);}K1.requiresIContext=true;function L1(i,j){return M1(i,j,1);}L1.requiresIContext=true;function M1(i,j,k){var X2=E(i,j),Y2=X2[k];if(Y2&&Y2.Value&&Y2.Value.Path){return Y2.Value.Path;}return"";}function N1(i,j){return R(i,j,0);}N1.requiresIContext=true;function O1(i,j){return R(i,j,1);}O1.requiresIContext=true;function P1(i,j){return R(i,j,2);}P1.requiresIContext=true;function Q1(i,j){return R(i,j,3);}Q1.requiresIContext=true;function R1(i,j){return R(i,j,4);}R1.requiresIContext=true;function S1(i,j,k){return Q(i,j,k);}S1.requiresIContext=true;function T1(i,j,k){return X(i,j,k);}T1.requiresIContext=true;function U1(i,j,k,X2){var Y2=J1(i,j);if(Y2>0){return T1(i,j,k);}else{return S1(i,j,X2);}}U1.requiresIContext=true;function V1(i,j,k){return o2(i,j,k);}V1.requiresIContext=true;function W1(i,j){return U(i,j,0);}W1.requiresIContext=true;function X1(i,j){return U(i,j,1);}X1.requiresIContext=true;function Y1(i,j){return U(i,j,2);}Y1.requiresIContext=true;function Z1(i,j){return W(i,j,0);}Z1.requiresIContext=true;function $1(j,k){for(var i=0;i<k.length;i++){var X2=k[i];if(X2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(X2.IconUrl&&X2.IconUrl.String){return X2.IconUrl.String;}if(X2.IconUrl&&X2.IconUrl.Path){return O.simplePath(j,X2.IconUrl);}}}}$1.requiresIContext=true;function _1(i,j,k){var X2="";var Y2;if(q.isArray(j)){Y2=E(i,j)[k];}else{var Z2=q.extend({},j);var $2=q.extend({},i);Y2=m2($2,Z2);}if(!Y2||!Y2.Value){return X2;}var _2=i.getSetting('ovpCardProperties');var a3=_2&&_2.getProperty("/entityType");var b3=_2&&_2.getProperty("/metaModel");var c3=b3&&b3.getODataProperty(a3,Y2.Value.Path);var d3=c3&&c3["Org.OData.Measures.V1.ISOCurrency"];if(d3&&d3.Path){X2+=(" "+c1([d3.Path]));}else if(d3&&d3.String){X2+=(" "+d3.String);}return X2;}_1.requiresIContext=true;function a2(i,j,k,X2){return X(i,j,k,X2);}a2.requiresIContext=true;function b2(i,j){return j1(i,j,0);}b2.requiresIContext=true;function c2(i,j){return m1(i,j,0);}c2.requiresIContext=true;function d2(i,j){return j1(i,j,1);}d2.requiresIContext=true;function e2(i,j){return j1(i,j,2);}e2.requiresIContext=true;function f2(i,j){return o1(i,j,0);}f2.requiresIContext=true;function g2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return v(j,g.ColorValues);}function h2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return p1(i,j,g.ColorValues);}}h2.requiresIContext=true;function i2(i,j){return Y(i,j,0);}i2.requiresIContext=true;function j2(i,j){var k=E(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}j2.requiresIContext=true;function k2(i,j){return Y(i,j,1);}k2.requiresIContext=true;function l2(i,j){return Y(i,j,2);}l2.requiresIContext=true;function m2(i,j){var k=i.getPath(0);var X2=k.slice(0,k.lastIndexOf("/"));X2=X2.slice(0,X2.lastIndexOf("/"));var Y2=K(X2,j);j=i.getModel(0).getProperty(Y2);return j;}function n2(i,j){if(!j){return"";}return $(i,j);}n2.requiresIContext=true;function o2(j,k,X2,Y2){var Z2;var $2=Y2==undefined?X2:B(j,X2)[Y2];var _2=j.getSetting('ovpCardProperties');var a3=_2.getProperty("/metaModel");var b3=a3.getODataEntityType(k.entityType);var c3=b3.property;if(c3){for(var i=0;i<c3.length;i++){if($2.Value.Path===c3[i].name){Z2=c3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(Z2){return O.format(j,Z2);}else{return"";}}}}}function p2(i,j,k){if(!j){return"";}var X2=i.getSetting('ovpCardProperties');var Y2=X2.getProperty("/entityType");var Z2=X2.getProperty("/metaModel");var $2=q.extend({},j);var _2=q.extend({},i);j=m2(_2,$2);return _(i,j,Y2,Z2,k);}p2.requiresIContext=true;function q2(i,j){var k=q.extend({},j);var X2=q.extend({},i);var Y2="None",Z2=g.StateValues;j=m2(X2,k);if(j&&j.Criticality){Y2=n1(i,j,Z2);}else{Y2=p1(i,j,Z2);}return Y2;}q2.requiresIContext=true;function r2(i,j){var k=q.extend({},j);var X2=q.extend({},i);j=m2(X2,k);if(j&&j.Criticality){return true;}}r2.requiresIContext=true;function s2(i,j){var k=q.extend({},j);var X2=q.extend({},i);var Y2=i.getSetting('ovpCardProperties');var Z2=Y2.getProperty("/entityType");var $2=Y2.getProperty("/metaModel");j=m2(X2,k);if(!j){return;}var _2=$2.getODataProperty(Z2,j.Value.Path);if(j&&_2&&_2.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return true;}}s2.requiresIContext=true;function t2(i,j){var k=q.extend({},j);var X2=q.extend({},i);j=m2(X2,k);var Y2="None";if(j&&j.Criticality&&j.Criticality.Path){Y2="{path:'"+j.Criticality.Path+"'}";}else{Y2=p1(i,j,g.StateValues);Y2=w(Y2);}return Y2;}t2.requiresIContext=true;function u2(j,k){var X2;for(var i=0;i<k.length;i++){X2=k[i];if(X2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||X2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||X2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}u2.requiresIContext=true;function v2(i,j){var k=E(i,j)[0];if(k&&k.Value&&k.Value.Path){var X2=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var Y2=i.getModel(0);var Z2=Y2.getProperty(X2);var $2=Y2.getODataProperty(Z2,k.Value.Path);if($2&&$2["Org.OData.Measures.V1.Unit"]){return $2["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}v2.requiresIContext=true;function w2(i){var j=i.getObject();var k=i.getModel();var X2=k.getProperty("/metaModel");var Y2=X2.getODataEntitySet(k.getProperty("/entitySet"));var Z2=X2.getODataEntityType(Y2.entityType);j=Z2.$path+"/"+j;return X2.createBindingContext(j);}function x2(j,k,X2,Y2,Z2){var $2="";var _2=new o.Model(o.Model.ReferenceByModel(j));var a3=_2.findQueryResultByName(k.name);if(!a3){$2="/"+k.name;return $2;}var b3=new o.QueryResultRequest(a3);var c3=a3.getParameterization();if(!c3){$2="/"+k.name;return $2;}if(Z2){var d3=Z2.getAnalyticalParameters();}if(c3){var e3;b3.setParameterizationRequest(new o.ParameterizationRequest(c3));if(X2&&X2.Parameters){q.each(X2.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){e3=this.PropertyNameFrom.PropertyPath.split("/");b3.getParameterizationRequest().setParameterValue(e3[e3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{e3=this.PropertyName.PropertyPath.split("/");b3.getParameterizationRequest().setParameterValue(e3[e3.length-1],this.PropertyValue.String);}});}else if(Y2){q.each(Y2,function(){b3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(d3&&d3.length>0){var f3=Z2&&Z2.getUiState({allFilters:false});var g3=f3?JSON.stringify(f3.getSelectionVariant()):"{}";var X2=new S(g3);for(var h3 in c3.getAllParameters()){for(var i=0;i<d3.length;i++){if(d3[i]&&(d3[i].name==h3)){var i3=d3[i].name;var j3=X2.getParameter(i3);if(!j3){var k3=X2.getSelectOption(i3);j3=k3&&k3[0]&&k3[0].Low;}b3.getParameterizationRequest().setParameterValue(h3,j3);}}}}else{$2="/"+k.name;q.sap.log.error("SelectionParameters","There are no parameters to resolve");return $2;}}try{$2=b3.getURIToQueryResultEntitySet();}catch(l3){a3=b3.getQueryResult();$2="/"+a3.getEntitySet().getQName();q.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+l3||l3.message);}return $2;}function y2(j,k,ns){var X2=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<X2.length;i++){if(ns+"."+X2[i].name===k){return X2[i];}}}function z2(i,j){var k=i.filter(function(Y2){if(Y2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var X2=M(k);if(X2){return X2[j];}return;}function A2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=z2(k,0);return o2(i,j,k);}A2.requiresIContext=true;function B2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=z2(k,1);return o2(i,j,k);}B2.requiresIContext=true;function C2(i,j){var k=i.filter(function(Y2){if(Y2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&Y2.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var X2=M(k);if(X2){return X2[j];}return;}function D2(i){if(!i||!i.length||i.length===0){return false;}var j=C2(i,0);if(j){return true;}return false;}function E2(i,j,k,X2){var Y2,Z2,$2;if(k&&k.Value&&k.Value.Path){Y2=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){Y2=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){Z2=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){$2=k.Title.Path;}var _2="";var a3=X2&&X2.Parameters;var b3="";var c3=i.getSetting('ovpCardProperties'),d3=c3.getProperty('/parameters');a3=a3||!!d3;if(a3){var e3=i.getSetting("dataModel");var f3=x2(e3,j,X2,d3);_2+="{path: '"+f3+"'";}else{_2+="{path: '/"+j.name+"'";}_2+=", length: 1";var g3=i.getSetting('ovpCardProperties');var h3=g3.getProperty("/entityType");var i3=C.getUnitColumn(Y2,h3);var j3=B1(g3,X2);if(j3.length>0){b3+=", filters: "+JSON.stringify(j3);}var k3=[];k3.push(Y2);if(Z2){k3.push(Z2);}else if($2){k3.push($2);}if(k&&k.Criticality&&k.Criticality.Path){k3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){k3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){k3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){k3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){k3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(i3){k3.push(i3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){k3.push(k.TrendCalculation.ReferenceValue.Path);}return _2+", parameters:{select:'"+k3.join(",")+"'}"+b3+"}";}E2.requiresIContext=true;function F2(k){if(isNaN(k)){return k;}var i,j,X2=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){X2=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var Y2=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(X2){return Y2.format(Number(k))+" %";}else{return Y2.format(Number(k));}}}function G2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var X2=j.getProperty("/metaModel");var Y2=X2.getODataProperty(k,i.Value.Path);if(Y2["Org.OData.Measures.V1.Unit"]){var Z2=Y2["Org.OData.Measures.V1.Unit"];if(Z2.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function H2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=F1(j.Value);var X2=F1(j.TrendCalculation.ReferenceValue);var Y2=F1(j.TrendCalculation.DownDifference);var Z2=F1(j.TrendCalculation.UpDifference);var $2=r1(X2);var _2=r1(Y2);var a3=r1(Z2);var b3="parts: ["+k;b3+=$2?","+X2:"";b3+=_2?","+Y2:"";b3+=a3?","+Z2:"";b3+="]";var c3=function(){var e3=1;return z(arguments[0],$2?arguments[e3++]:X2,_2?arguments[e3++]:Y2,a3?arguments[e3++]:Z2);};var d3=u(c3,"formatTrendDirection");return"{"+b3+", formatter: '"+d3+"'}";}H2.requiresIContext=true;function I2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function J2(k,i){var j,X2,Y2,Z2,$2=false;if(isNaN(+k)){return"";}if(k==0){Z2=i;}else{Z2=k;}X2=this.getModel('ovpCardProperties');if(X2.getProperty("/iNumberOfFractionalDigits")){Y2=+(X2.getProperty("/iNumberOfFractionalDigits"));}if(X2.getProperty("/bPercentageAvailableForTarget")){$2=true;}if(i){j=i;}else{if(X2.getProperty("/sManifestTargetValue")){j=X2.getProperty("/sManifestTargetValue");}}if(!Y2||Y2<0){Y2=0;}else if(Y2>2){Y2=2;}if(j){var _2=N.getFloatInstance({minFractionDigits:Y2,maxFractionDigits:Y2,style:"short",showScale:true,shortRefNumber:Z2});if($2){return _2.format(+(j))+" %";}else{return _2.format(+(j));}}}function K2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var X2=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var Y2=X2.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(Y2["Org.OData.Measures.V1.Unit"]){var Z2=Y2["Org.OData.Measures.V1.Unit"];if(Z2.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function L2(k,i){var j,X2,Y2;if(isNaN(+k)){return"";}k=+(k);Y2=this.getModel('ovpCardProperties');if(Y2.getProperty("/iNumberOfFractionalDigits")){j=+(Y2.getProperty("/iNumberOfFractionalDigits"));}if(i){X2=+(i);}else{if(Y2.getProperty("/sManifestTargetValue")){X2=+(Y2.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(X2){var Z2=((k-X2)/X2);var $2=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return $2.format(Z2);}}function M2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function N2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var X2=this.getModel('ovpCardProperties').getProperty("/metaModel");var Y2=this.getModel('ovpCardProperties').getProperty("/entityType");var Z2;if(i.GroupBy.constructor===Array){Z2=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{Z2=i.GroupBy.Collection;}var $2;q.each(Z2,function(){$2=U2(X2,Y2,this.PropertyPath);if(!$2){return;}j+=$2;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("By",[j]);}function O2(i,j,k){var X2=true;var Y2=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][Y2].PropertyName.PropertyPath){X2=false;}j=[j];var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/entityType");var _2=Z2.getProperty("/metaModel");var a3=B1(Z2,j);if(a3.length==0){return"";}var b3;var c3;b3=a3[0].path;c3=V2(_2,$2,b3);if(c3!==b3){return"";}var d3=S2(a3);if(X2===true){return d3+", ";}return d3;}O2.requiresIContext=true;function P2(i,j,k){var X2=!(j.index===(k.length-1));var Y2=S2([k[j.index]]);if(X2===true){return Y2+", ";}return Y2;}P2.requiresIContext=true;function Q2(i){return i.id;}function R2(i){return i.id;}function S2(j){var k=[];for(var i=0;i<j.length;i++){k.push(T2(j[i]));}return k.join(', ');}function T2(i){var j=false;var k=i.value1;if(i.operator[0]==="N"){j=true;}if(i.value2){k+=" - "+i.value2;}if(j){k=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("kpiHeader_Filter_NotOperator",[k]);}return k;}function U2(i,j,k){return W2(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function V2(i,j,k){return W2(i,j,k,"sap:text");}function W2(i,j,k,X2){var Y2=i.getODataProperty(j,k);if(!Y2){q.sap.log.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var Z2=Y2[X2];if(Z2){if(X2==="com.sap.vocabularies.Common.v1.Label"){return Z2.String;}return Z2;}return Y2.name;}return{NumberFormatFunctions:c,DateFormatFunctions:d,CurrencyFormatFunctions:e,formatFunctions:f,criticalityConstants:g,TextArrangementType:T,formatterGeo:h,criticalityType:m,getCriticalityStateFromValue:n,getLabelForDataItem:r,colorPaletteForComparisonMicroChart:l1,formatField:$,formatItems:t1,getCardSelections:y1,getCardSorters:z1,getFilters:B1,getPrimitiveValue:E1,removeDuplicateDataField:H1,formatUrl:I1,getDataPointsCount:J1,getFirstDataPointValue:K1,getFirstDataFieldName:N1,getSecondDataFieldName:O1,getThirdDataFieldName:P1,formatDataFieldValueOnIndex:S1,formatDataPointValueOnIndex:T1,formatDataPointOrField:U1,formatsemanticObjectOfDataFieldGeneric:V1,getLabelForFirstDataPoint:Z1,formatImageUrl:$1,formatUnit:_1,formatObjectNumber:a2,formatFirstDataPointState:b2,formatFirstDataPointColor:c2,formatSecondDataPointState:d2,formatThirdDataPointState:e2,formatFirstDataPointStateForSmartField:f2,formatKPIHeaderState:h2,isFirstDataPointCriticality:i2,isFirstDataPointCriticalityForTableStatus:j2,getSortedDataFields:B,getSortedDataPoints:E,formatDataFieldValueGeneric:n2,formatDataPointValue:p2,formatDataPointStateGeneric:q2,checkCriticalityGeneric:r2,checkCriticalityGenericForTableStatus:s2,formatDataPointStateForSmartFieldGeneric:t2,hasActions:u2,isFirstDataPointPercentageUnit:v2,resolveEntityTypePath:w2,resolveParameterizedEntitySet:x2,getAssociationObject:y2,semanticObjectOfFirstDataField:A2,semanticObjectOfSecondDataField:B2,isFirstContactAnnotation:D2,getAggregateNumber:E2,KpiValueFormatter:F2,kpiValueCriticality:g2,formThePathForAggregateNumber:G2,formThePathForTrendIcon:H2,formPathForPercentageChange:I2,TargetValueFormatter:J2,formPathForTargetValue:K2,returnPercentageChange:L2,isPresentationVarientPresent:M2,listGroupBy:N2,formTheFilterByString:O2,formTheFilterByStringNotFromSelVar:P2,formTheIdForFilter:Q2,formTheIdForFilterNotFromSelVar:R2,_criticality2state:v,_calculateCriticalityState:y,_calculateTrendDirection:z,_getPropertiesFromBindingString:w1,sortCollectionByImportance:M};},true);
