// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["jquery.sap.global",'sap/ushell/renderers/fiori2/search/appsearch/AppSearchInMemoryProvider','sap/ushell/renderers/fiori2/search/appsearch/AppSearchEsProvider'],function($,A,a){"use strict";function S(o,c){this.init.apply(this,arguments);}S.prototype={init:function(o,c,p,s){this.oAdapter=o;this.oContainerInterface=c;this.oLpdService=sap.ushell.Container.getService("LaunchPage");var b={optimizedAppSearch:false};if(s&&s.config&&s.config.optimizedAppSearch!==undefined){b.optimizedAppSearch=s.config.optimizedAppSearch;}this.appSearchInMemoryProvider=new A(b);this.appSearchEsProvider=new a(b);},isSearchAvailable:function(){return this.oAdapter.isSearchAvailable();},getSina:function(){return this.oAdapter.getSina();},prefetchTiles:function(){return this.getAppSearchProvider().then(function(b){return b.prefetchTiles();});},getUrlParameter:function(n,u){if(!u)u=window.location.href;n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),b=r.exec(u);if(!b)return null;if(!b[2])return'';return decodeURIComponent(b[2].replace(/\+/g," "));},getAppSearchProvider:function(){if(this.appSearchProviderDeferred){return this.appSearchProviderDeferred;}this.appSearchProviderDeferred=new $.Deferred();var b=this.getUrlParameter('appSearchProvider');if(b){switch(b){case'es':this.appSearchProviderDeferred.resolve(this.appSearchEsProvider);break;case'memory':this.appSearchProviderDeferred.resolve(this.appSearchInMemoryProvider);break;default:this.appSearchProviderDeferred.resolve(this.appSearchInMemoryProvider);}return this.appSearchProviderDeferred;}this.appSearchEsProvider.isActive().then(function(i){i=false;if(i){this.appSearchProviderDeferred.resolve(this.appSearchEsProvider);}else{this.appSearchProviderDeferred.resolve(this.appSearchInMemoryProvider);}}.bind(this));return this.appSearchProviderDeferred;},queryApplications:function(q){q.top=q.top||10;q.skip=q.skip||0;return this.getAppSearchProvider().then(function(b){return b.search(q);}.bind(this)).then(function(s){return{totalResults:s.totalCount,searchTerm:q.searchTerm,getElements:function(){return s.tiles;}};}.bind(this));},queryApplicationsByTarget:function(s,r){this._getCatalogTiles().done(function(c){var R=[];for(var j=0,l=s&&s.length||0;j<l;j++){var o=s[j],u=sap.ushell.Container.getService("URLParsing");for(var i=0;i<c.length;i++){var t=u.parseShellHash(c[i].url);if(t&&(t.semanticObject===o.semanticObject)&&(t.action===o.action)){R.push(c[i]);break;}}}r(R);});}};S.hasNoAdapter=false;return S;},true);
