sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/BeforeSaveHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/StatePreserver","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,c,C,S,t){"use strict";var s=(t.testableStatic(function(T,o){var h="sapUiSizeCozy",i="sapUiSizeCompact";if(o.hasClass(h)||o.hasClass(i)){return"";}else{return T?h:i;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return s;}function f(o,p){q.sap.syncStyleClass(s,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;var n=Object.create(null);function h(){return l;}function k(i){l=i;}function m(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function p(i){T.fnAddSideEffectPromise(i);}function u(i){if(I){return;}var j=q.grep(T.aRunningSideEffectExecutions,function(o1){return!!o1;});if(j.length){I=true;Promise.all(j).then(function(){I=false;u(i);});}else{i();}}function v(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var o1=i[j];i[j]=function(){var p1=arguments;u(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){o1.apply(i,p1);});}});};}}var F={};function w(i,j,o1,p1,q1){i=i||T.oNavigationHost;var r1=i.getId();var s1=F[r1]||(F[r1]={});var t1=s1[j];if(!t1){t1=sap.ui.xmlfragment(r1,j,o1);f(t1,i);var u1;if(p1){u1=new J();t1.setModel(u1,p1);}(q1||q.noop)(t1,u1);s1[j]=t1;v(t1);}return t1;}function x(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function y(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function z(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var G=false;function K(i){G=i;}function L(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var o1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(o1);}function R(i){T.aStateChangers.push(i);}function N(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function O(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function Q(i,j,o1){var p1=T.mEntityTree[i];var q1;if(p1.navigationProperty&&p1.parent){q1=j?p1.entitySet:p1.navigationProperty;}else{q1=i;}if(o1.indexOf(q1)<0){o1.unshift(q1);if(p1.navigationProperty&&p1.parent){Q(p1.parent,j,o1);}}}function U(i,j){var o1=[];Q(i,j,o1);return o1;}function V(j){var o1=U(j);o1.pop();var p1="";var q1="";var r1=[];for(var i=0;i<o1.length;i++){p1=p1+q1+o1[i];r1.push(p1);q1="/";}return r1;}function W(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var o1=j.split("/");if(o1[0]===""||o1[0]==="#"){o1.splice(0,1);}return o1;}function X(i,j,o1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,o1);}return i;}function Y(){var j=T.oNavigationControllerProxy.getActiveComponents();var o1=0;var p1;for(var i=0;i<j.length;i++){var q1=T.componentRegistry[j[i]];if(q1.viewLevel>0&&(o1===0||q1.viewLevel<o1)){o1=q1.viewLevel;p1=q1.oComponent;}}var r1=p1?Promise.resolve(p1):T.oNavigationControllerProxy.getRootComponentPromise();return r1.then(function(s1){return s1.getModel("i18n").getResourceBundle();});}function Z(){return T.oNavigationControllerProxy.getAppTitle();}function $(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function _(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function a1(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(m(j.oComponent)){var o1=j.oComponent.getComponentContainer().getElementBinding();return o1&&o1.getPath();}else{return null;}}}return null;}function b1(o1,p1,q1,r1,s1){var t1=q1.oComponent.getEntitySet();var u1=T.mEntityTree[t1];var v1=false;var w1;var x1=true;for(var i=0;i<u1.children.length&&!w1;i++){var y1=u1.children[i];var z1=T.mEntityTree[y1];if(z1.navigationProperty===o1){w1=z1.sRouteName;x1=!z1.noKey;}}if(r1&&!w1){var A1=u1.embeddedComponents[r1];if(A1){for(var j=0;j<A1.pages.length&&!v1;j++){var B1=A1.pages[j];if(B1.navigationProperty===o1){v1=true;w1=t1+"/"+r1+"/"+o1;x1=!(B1.routingSpec&&B1.routingSpec.noKey);}}}}if(w1){var C1=v1?r1+r.getPatternDelimiter():"";var D1=x1?"("+p1+")":"";var E1=C1+o1+D1;T.oNavigationControllerProxy.navigateToSuffix(E1,q1.viewLevel+1,w1,s1);}}var c1;function d1(j,o1){var i=o1||0;if(i>0){return null;}var p1=j.getEntitySet();var q1=T.mEntityTree[p1];var r1=q1&&q1.communicationObject;for(;i<0&&r1;){q1=T.mEntityTree[q1.parent];if(q1.communicationObject!==r1){i++;r1=q1.communicationObject;}}if(i<0||r1){return r1;}c1=c1||{};return c1;}function e1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function f1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function g1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var o1=j[i];var p1=T.componentRegistry[o1];var q1=p1.methods.currentDraftModified&&p1.methods.currentDraftModified();if(q1){o.markDraftAsModified(q1);}}}function h1(){if(E!==undefined){return E;}var i,j,o1,p1,q1,r1,s1=true;var t1=T.oAppComponent.getModel();var u1=t1.getMetaModel();var v1=t1.mContexts;for(o1 in v1){s1=false;q1=v1[o1].sPath;p1=q1&&q1.substring(1,q1.indexOf('('));r1=p1&&u1.getODataEntitySet(p1);if(r1){i=t1.getProperty(q1);j=i&&t1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(s1){return true;}E=false;return E;}function i1(j){var i,o1,p1;var q1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<q1.length;i++){o1=q1[i];if(!j||!j[o1]){p1=T.componentRegistry[o1];p1.utils.refreshBinding(true);}}}function j1(i){if(T.oFlexibleColumnLayoutHandler){T.oFlexibleColumnLayoutHandler.setStoredTargetLayoutToFullscreen(i);}}function k1(){T.oPaginatorInfo={};}function l1(i){return new S(T,i);}function m1(i,j){return new c(T,i,j);}function n1(j,o1){var p1=n[j];if(!p1){p1=Object.create(null);n[j]=p1;var q1=T.oAppComponent.getModel();var r1=q1.getMetaModel();var s1=r1.getODataEntitySet(j);var t1=s1&&r1.getODataEntityType(s1.entityType);var u1=(t1&&t1.navigationProperty)||[];for(var i=0;i<u1.length;i++){var v1=u1[i];p1[v1.name]=v1;}}return p1[o1];}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,areTwoKnownPathesIdentical:o.areTwoKnownPathesIdentical,getResourceBundleForEditPromise:Y,getHierarchySectionsFromCurrentHash:W,getContentDensityClass:g,setEditableNDC:K,getDialogFragment:w.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:k,markCurrentDraftAsModified:g1,prepareDeletion:O,performAfterSideEffectExecution:u};return{setEditableNDC:K,getEditableNDC:function(){return G;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:w,getBusyHelper:function(){return T.oBusyHelper;},addSideEffectPromise:p,performAfterSideEffectExecution:u,isComponentActive:m,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([x(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:y,getFclProxyForView:z,isNewHistoryEntryRequired:L,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:N,getBreadCrumbInfo:V,adaptBreadCrumbUrl:X,getSections:U,getHierarchySectionsFromCurrentHash:W,getAppTitle:Z,subTitleForViewLevelChanged:$,getCurrentKeys:_,getPathForViewLevelOneIfVisible:a1,getCommunicationObject:d1,navigateRoute:b1,getForwardNavigationProperty:e1,getMaxColumnCountInFCL:f1,getListReportTable:h,markCurrentDraftAsModified:g1,checkEtags:h1,refreshAllComponents:i1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T),setStoredTargetLayoutToFullscreen:j1,invalidatePaginatorInfo:k1,getStatePreserver:l1,getBeforeSaveHelper:m1,getNavigationProperty:n1};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});
