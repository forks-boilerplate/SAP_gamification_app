/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define("sap/suite/ui/commons/TimelineRenderManager",["jquery.sap.global","./library","sap/m/Text","sap/ui/core/Icon","sap/m/ViewSettingsDialog","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/m/ButtonType","sap/m/ToolbarSpacer","sap/m/SearchField","sap/m/OverflowToolbar","sap/m/Select","sap/m/RangeSlider","sap/m/Label","sap/m/Panel","sap/m/FlexBox","sap/m/OverflowToolbarButton","sap/m/MessageStrip","sap/ui/core/CSSSize","sap/m/ViewSettingsFilterItem","sap/m/ViewSettingsCustomItem","sap/m/OverflowToolbarLayoutData","sap/m/OverflowToolbarPriority","sap/m/MessageToast","sap/ui/core/InvisibleText","sap/m/SliderTooltip","sap/suite/ui/commons/TimelineRenderManagerTimestamp"],function(q,l,T,I,V,R,a,B,b,S,O,c,d,L,P,F,f,M,C,g,h,k,m,n,o,p,r){"use strict";var s=l.TimelineGroupType;var t=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var u=680;var D=Object.freeze({UP:"UP",DOWN:"DOWN",NONE:"NONE"});function v($,e,i){$.removeClass(e).addClass(i);}function _($,A){return parseInt($.css(A).replace("px",""),10);}var w={extendTimeline:function(x){x.prototype._initControls=function(){this._setupMessageStrip();this._setupFilterDialog();this._setupHeaderToolbar();this._setupAccessibilityItems();};x.prototype._registerResizeListener=function(){var e=this.$().parent().get(0);if(e){this.oResizeListener=R.register(e,q.proxy(this._performResizeChanges,this));}};x.prototype._deregisterResizeListener=function(){if(this.oResizeListener){R.deregister(this.oResizeListener);}};x.prototype._performUiChanges=function(e){this._deregisterResizeListener();if(!this.getDomRef()){return;}if(this._isVertical()){this._performUiChangesV(e);}else{this._performUiChangesH();}this._setupScrollers();this._startItemNavigation();this._registerResizeListener();};x.prototype._performDoubleSidedChangesLi=function($,i){var e=$.children().first(),j=this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight";if(this._renderDblSided){if($.hasClass('sapSuiteUiCommonsTimelineItem')){$.removeClass('sapSuiteUiCommonsTimelineItem').addClass(i?"sapSuiteUiCommonsTimelineItemOdd":"sapSuiteUiCommonsTimelineItemEven");if(!i){v(e,"sapSuiteUiCommonsTimelineItemWrapperVLeft","sapSuiteUiCommonsTimelineItemWrapperVRight");}else{v(e,"sapSuiteUiCommonsTimelineItemWrapperVRight","sapSuiteUiCommonsTimelineItemWrapperVLeft");}}}else{$.removeClass("sapSuiteUiCommonsTimelineItemOdd").removeClass("sapSuiteUiCommonsTimelineItemEven").addClass("sapSuiteUiCommonsTimelineItem");e.removeClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight").addClass(j);}};x.prototype._performDoubleSidedChanges=function(){var $=this.$(),e=$.find('.sapSuiteUiCommonsTimelineItemUlWrapper').not(".sapSuiteUiCommonsTimelineShowMoreWrapper"),y=$.find(".sapSuiteUiCommonsTimelineScrollV .sapSuiteUiCommonsTimelineGroupHeader"),z;if(this._renderDblSided){this._$content.addClass("sapSuiteUiCommonsTimelineDblSided");y.addClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided");y.addClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight");}else{this._$content.removeClass("sapSuiteUiCommonsTimelineDblSided");y.removeClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided sapSuiteUiCommonsTimelineItemWrapperVLeft");y.addClass(this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");}for(var j=0;j<e.length;j++){var A=q(e[j]),E=A.find('> li').not(".sapSuiteUiCommonsTimelineGroupHeader");E.eq(1).css("margin-top",this._renderDblSided?"40px":"auto");for(var i=0;i<E.length;i++){z=q(E[i]);this._performDoubleSidedChangesLi(z,(i%2)===0);}}$.find(".sapSuiteUiCommonsTimelineItemBarV").css("height","");$.find(".sapSuiteUiCommonsTimelineItem").css("margin-bottom","");};x.prototype._performUiChangesH=function(){var $=this.$(),e,i;var j=function(y){return($.width()-(y.position().left+y.outerWidth()));};if(this.getEnableDoubleSided()&&this._isGrouped()){i=$.find(".sapSuiteUiCommonsTimelineHorizontalBottomLine ul");$.find("[firstgroupevenitem = true]:visible").each(function(y,z){var A=function(U){return U+"-"+(this._bRtlMode?"right":"left");}.bind(this),E=q("#"+z.id+"-line"),G=this._bRtlMode?j(E):E.position().left,H=30,J=q(z),K=_(i,A("padding")),N,Q;if(y===0){N=G-H-K;}else{e=J.prevAll(".sapSuiteUiCommonsTimelineItemLiWrapperV:visible:first");Q=this._bRtlMode?j(e):(e.position().left+_(e,A("margin")));N=(G-H)-(Q+e.outerWidth());}J.css(A("margin"),N+"px");}.bind(this));}if(!this.getEnableScroll()){$.find(".sapSuiteUiCommonsTimelineContentsH").css("overflow-x","hidden");}this._calculateTextHeight();};x.prototype._performUiChangesV=function(e){var $=this.$(),i=$.outerWidth()+50;if(this.getEnableDoubleSided()){this._renderDblSided=i>=u;if(this._renderDblSided!==this._lastStateDblSided||e){this._performDoubleSidedChanges();}this._lastStateDblSided=this._renderDblSided;}this._calculateTextHeight();this._calculateHeightV();};x.prototype._calculateHeightV=function(){var $=this.$(),e=this.$("headerBar").outerHeight()||0,j=this.$("filterMessage").outerHeight()||0,y=this.$("messageStrip").outerHeight()||0,z=y+j+e,A=function(K,J){var N,Q,W,X,Y,Z,a1,b1=K.length,c1=this.getShowIcons()?".sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible":".sapSuiteUiCommonsTimelineItemNoIcon:visible",d1=J.length>0?J.find(c1+", .sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible").eq(0):q(),e1=8;for(var i=0;i<b1;i++){N=q(K[i+1]);Q=q(K[i]);W=i<b1-1?N.find(c1):d1;Y=Q.find(c1);if(W.length>0&&Y.length>0){Z=W.offset().top;a1=Y.offset().top+Y.height();X=Q.find(".sapSuiteUiCommonsTimelineItemBarV");e1=8;X.height(Z-a1-e1);}}},E=function(K){var N,Q,W,X,Y,Z=40,a1=100,b1=function(){var c1=_(W,"margin-top")+W.position().top+W.height()-N.position().top;Q.css("margin-bottom",c1+Z+"px");};for(var i=2;i<K.length;i++){N=q(K[i]);Q=q(K[i-1]);W=q(K[i-2]);X=this._bRtlMode?!N.hasClass("sapSuiteUiCommonsTimelineItemOdd"):N.hasClass("sapSuiteUiCommonsTimelineItemOdd");Y=N.position().left;if(!X&&Y<a1||X&&Y>a1){b1();}else{var c1=N.position().top-Q.position().top,d1=_(W,"margin-bottom");if(c1<Z){W.css("margin-bottom",d1+Z-c1);}}}},G=function(){var N=5,Q=$.position().top,W=$.parent().height(),X=_(this._$content,"padding-bottom"),Y=_(this._$content,"padding-top"),Z=W-Q-z-Y-X-N;this._$content.height(Z);}.bind(this),U,H,J,K;if(this.getEnableScroll()){G();}if(this._renderDblSided){U=$.find(".sapSuiteUiCommonsTimelineItemUlWrapper");for(var i=0;i<U.length;i++){H=q(U[i]);J=q(U[i+1]);K=H.find(" > li:not(.sapSuiteUiCommonsTimelineGroupHeader):visible");K.css("margin-bottom","");E.call(this,K,H);A.call(this,K,J);}}};x.prototype._performResizeChanges=function(){this._performUiChanges();};x.prototype._calculateTextHeight=function(){var $=this.$(),e=this.getTextHeight(),j,y,z=function(H,J){$.find(".sapSuiteUiCommonsTimelineItemTextWrapper:visible").each(function(K,W){var N=q(W),Q=N.children().first(),U=Q.get(0).getClientRects(),X=0,Y=0,Z,a1=-100000,b1=0,c1=N.attr("expanded");if(!c1){if(U&&U.length>0){Z=U[0].top;b1=0;for(var i=0;i<U.length-1;i++){if(a1!==U[i].bottom){a1=U[i].bottom;b1++;}if(H>0&&(U[i+1].bottom-Z>H)){Y=b1;X=U[i].bottom-Z;break;}if(J>0&&b1===J){X=U[i].bottom-U[0].top;Y=J;break;}}}if(X>0){N.height(X);N.css("-webkit-line-clamp",Y.toString());N.next().show();}else if(!N.attr("expandable")){N.next().hide();}}});},A=function(i){z(0,parseInt(i,10));},E=function(H){z(H,0);},G=function(){var i=$.find(".sapSuiteUiCommonsTimelineItemTextWrapper");i.css("height","");i.css("-webkit-line-clamp","");$.css("height","100%");var H=this._$content.height(),J=_(this._$content,"padding-bottom"),K=this._$content.get(0).scrollHeight,N=K-H-J,Q={height:0},U,W=20;$.find(".sapSuiteUiCommonsTimelineItemTextWrapper").each(function(X,Y){var Z=q(Y).height();if(Z>Q.height){Q.height=Z;Q.item=q(this);}});if(Q.item){U=Q.item.parent().find(".sapSuiteUiCommonsTimelineItemShowMore:hidden").height();return Q.height-N-U-W;}return 1;};if(e){if(this._useAutomaticHeight()){E(G.call(this));}else if(q.isNumeric(e)){A(e);}else{j=/([0-9]*\.?[0-9]+)(px)+/i;y=j.exec(e);if(y&&y.length>1){E(y[1]);}else if(C.isValid(e)){$.find(".sapSuiteUiCommonsTimelineItemTextWrapper").height(e);}}}};x.prototype._fixScrollerPositionH=function(){var $=this.$(),e=$.find(".sapSuiteUiCommonsTimelineHorizontalMiddleLine"),i=$.find(".sapSuiteUiCommonsTimelineHorizontalScroller"),j,y=this._$content.position().top;if(e.get(0)){j=e.position().top;$.find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").css("top",j-5);i.css("top",y+"px");i.height(this._$content.outerHeight()-15);}};x.prototype._setupScrollers=function(){var $=this.$(),e=450,N='rgba(0, 0, 0, 0)',i,j,y,z,G,A,E,H,J,K,Q,U,W,X=function(Y){var Z=N;Y.parents().each(function(a1,b1){var j=q(b1).css("background-color"),c1=q(b1).css("background-image");if(c1!=="none"){Z=N;return;}if(j!==N&&j!=="transparent"){Z=j;}});return Z;};if(this._scrollingFadeout()){i=this._isVertical()?$.height():$.width();if(i<e){$.find(".sapSuiteUiCommonsTimelineVerticalScroller",".sapSuiteUiCommonsTimelineHorizontalScroller").hide();this._scrollersSet=false;return;}if(!this._scrollersSet){j=X(this.$());if(j&&j!==N){y=j.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);if(y&&y.length>=4){z=parseInt(y[1],10);G=parseInt(y[2],10);A=parseInt(y[3],10);E="rgba("+z+","+G+","+A+", 0)";J="rgba("+z+","+G+","+A+", 0.7)";H="rgba("+z+","+G+","+A+", 1)";K=$.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller ");Q=$.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller");U=this._isVertical()?"top":"left";W=this._isVertical()?"bottom":"right";K.css("background-image","linear-gradient(to "+U+", "+E+", "+H+")");Q.css("background-image","linear-gradient(to "+W+", "+E+", "+H+")");K.css("background-image","-webkit-linear-gradient("+W+", "+E+", "+J+" 30%,"+H+")");Q.css("background-image","-webkit-linear-gradient("+U+", "+E+", "+J+" 30%,"+H+")");this._scrollersSet=true;if(this.getContent().length>0){if((!this._isVertical()&&this._$content.get(0).scrollWidth>this._$content.outerWidth())||(this._isVertical()&&this._$content.get(0).scrollHeight>this._$content.outerHeight())){Q.show();}}}}else{$.find(".sapSuiteUiCommonsTimelineHorizontalScroller").hide();}}if(!this._isVertical()){this._fixScrollerPositionH();}}};x.prototype._setupScrollEvent=function(){var $=this.$(),e=$.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineTopScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),i=$.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineBottomScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),j=$.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller"),y=$.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller"),z=this._$content,A=this;if(A._lazyLoading()||A._scrollingFadeout()){z.on("scroll",function(E){var G=q(E.currentTarget),H=G.get(0).scrollLeft,J=G.get(0).scrollTop,K=false,N=200,Q=5,U=false,W,X,Y,Z,z;if(A._isVertical()){W=G.outerHeight();X=G.get(0).scrollHeight;U=J+W>X-N;K=J+W>=X-Q;}else{Y=G.width();Z=G.get(0).scrollWidth;U=H+Y>Z-N;K=H+Y>=Z-Q-185;}if(A._lazyLoading()&&A._scrollMoreEvent){if(U&&!A._isMaxed()){A._scrollMoreEvent=false;A._loadMore();}}if(A._scrollersSet){if(H>50||J>50){j.show();}else{j.hide();A._manualScrolling=false;}if(K){y.hide();}else{y.show();}var a1;if(A._isVertical()){a1=G.get(0).scrollTop;z=a1>A._lastScrollPosition.y?i:e;A._lastScrollPosition.y=a1;}else{a1=G.get(0).scrollLeft;z=a1>A._lastScrollPosition.x?i:e;A._lastScrollPosition.x=a1;}z.addClass("sapSuiteUiCommonsTimelineScrolling");clearTimeout(q.data(this,'scrollTimer'));q.data(this,'scrollTimer',setTimeout(function(){e.removeClass("sapSuiteUiCommonsTimelineScrolling");i.removeClass("sapSuiteUiCommonsTimelineScrolling");},350));}});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").mousedown(function(E){var G=90,H=(q(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperLeft")||q(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperTop"))?-G:G;A._manualScrolling=true;A._performScroll(H);});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").mouseup(function(){A._manualScrolling=false;}).mouseout(function(){A._manualScrolling=false;});}if(this.getEnableScroll()){this._$content.on("wheel",function(E){var G=E.originalEvent.deltaY,H=30;if(G<H&&G>H*-1){G=G>0?H:H*-1;}this.scrollLeft+=G*2;});$.find(".sapSuiteUiCommonsTimelineHorizontalScroller, .sapSuiteUiCommonsTimelineVerticalScroller").on("wheel",function(E){var G=E.originalEvent.deltaY;if(A._isVertical()){A._$content.get(0).scrollTop+=G*2;}else{A._$content.get(0).scrollLeft+=G*2;}});}};x.prototype._setupMessageStrip=function(){var e=this;this._objects.register("messageStrip",function(){return new M(e.getId()+"-messageStrip",{close:function(){e.setCustomMessage("");e.fireCustomMessageClosed();},showCloseButton:true});});this._objects.register("filterMessageText",function(){return new T(e.getId()+"-filterMessageText",{});});this._objects.register("filterMessage",function(){var i=e._objects.getFilterMessageText(),j,y;y=new I(e.getId()+"filterMessageIcon",{src:"sap-icon://decline",press:[e._clearFilter,e]});j=new O(e.getId()+"-filterMessage",{design:"Info",content:[i,new b(),y]});j.addStyleClass("sapSuiteUiCommonsTimelineFilterInfoBar");j.setHeight("auto");return j;});};x.prototype._setMessageBars=function(e){var i=this._getFilterMessage();if(i){e.addChild(this._objects.getFilterMessage());this._objects.getFilterMessageText().setText(i);}};x.prototype._setupRangeFilterPage=function(){var i=this;this._rangeFilterType=null;this._objects.register("timestampFilterPicker",function(){return new r(i.getId(),undefined,undefined,t);});this._objects.register("timeFilterSelect",function(){var e=new c(i.getId()+"-timeFilterSelect",{change:function(j){i._rangeFilterType=j.getParameter("selectedItem").getProperty("key");i.toggleGroupTypeSelector(i._rangeFilterType);i._setRangeFilter();},items:[new a({text:t.getText("TIMELINE_YEAR"),key:s.Year}),new a({text:t.getText("TIMELINE_QUARTER"),key:s.Quarter}),new a({text:t.getText("TIMELINE_MONTH"),key:s.Month}),new a({text:t.getText("TIMELINE_DAY"),key:s.Day}),new a({text:t.getText("TIMELINE_CUSTOM_RANGE"),key:s.None})]});e.addStyleClass("sapSuiteUiCommonsTimelineRangeSelect");return e;});this._objects.register("timeRangeSlider",function(){var j=new d(i.getId()+"-timeRangeSlider",{enableTickmarks:true,visible:false,showAdvancedTooltip:true,step:1,change:function(e){var y=j.getMin(),z=j.getMax(),A=j.getRange();i._filterDialogRangePage.setFilterCount(+(A[0]!==y||A[1]!==z));}});j._updateTooltipContent=function(y,N){var z,A;var E=function(){return i._rangeFilterType===s.Year;};if(z>i._maxDate){z=i._maxDate;}if(z<i._minDate){z=i._minDate;}try{z=i._fnAddDate(N);A=i._formatGroupBy(z,i._rangeFilterType).title;y.setValue(N);y.onAfterRendering=function(){try{if(this instanceof p&&p.prototype.onAfterRendering){p.prototype.onAfterRendering.apply(this);}var $=y.$("input");$.attr("type",null);$.val(A);$.parent().width(E()?"40px":"115px");}catch(e){}};y.$("input").attr("type",null);y.$("input").val(A);}catch(e){}};j.addStyleClass("sapSuiteUiCommonsTimelineRangeFilter");j.onAfterRendering=function(){d.prototype.onAfterRendering.apply(this);var e=this.$().find(".sapMSliderLabel");e.eq(0).html(i._formatGroupBy(i._minDate,i._rangeFilterType).title);e.eq(1).html(i._formatGroupBy(i._maxDate,i._rangeFilterType).title);};return j;});this._objects.register("rangeTypeLbl",function(){return new L(i.getId()+"-rangeTypeLbl",{text:t.getText("TIMELINE_GROUP_BY_PERIOD")+":"});});this._objects.register("rangeTypePanel",function(){var e=new P(i.getId()+"-rangeTypePanel",{content:[i._objects.getRangeTypeLbl(),i._objects.getTimeFilterSelect()]});e.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanel");e.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanelShadowed");return e;});this._objects.register("rangePanel",function(){return new F(i.getId()+"rangePanel",{direction:"Column",items:[i._objects.getRangeTypePanel(),i._objects.getTimeRangeSlider(),i._objects.getTimestampFilterPicker().getTimestampPanelRadio(),i._objects.getTimestampFilterPicker().getTimestampPanelPicker()]});});};x.prototype._setupFilterFirstPage=function(e){if(e){e.removeAllAggregation("filterItems");if(this.getShowItemFilter()){e.addAggregation("filterItems",new g({key:"items",text:this._getFilterTitle()}));}if(this.getShowTimeFilter()){this._filterDialogRangePage=new h({key:"range",text:t.getText("TIMELINE_RANGE_SELECTION"),customControl:[this._objects.getRangePanel()]});e.addAggregation("filterItems",this._filterDialogRangePage);}}};x.prototype._setupFilterDialog=function(){var e=this;this._setupRangeFilterPage();this._objects.register("filterContent",function(){var i,j,y=function(G){if(!e._filterState.data){e._setFilterList();G.removeAllItems();e._aFilterList.forEach(function(H){var J=q.grep(e._currentFilterKeys,function(K){return H.key===K.key;}).length>0;G.addItem(new g({key:H.key,text:H.text,selected:J}));});}e._filterState.data=true;},z=function(){n.show(t.getText("TIMELINE_NO_LIMIT_DATA"));},A=function(){if(!e._filterState.range){E.setBusy(true);e._getTimeFilterData().then(function(){E.setBusy(false);if((!e._minDate||!e._maxDate)||(!(e._minDate instanceof Date)||!(e._maxDate instanceof Date))){z();return;}if(!e._rangeFilterType){e._rangeFilterType=e._calculateRangeTypeFilter();}if(!e._startDate&&!e._endDate){e._setRangeFilter();}else{i=e._fnDateDiff(e._rangeFilterType,e._minDate,e._startDate);j=e._fnDateDiff(e._rangeFilterType,e._minDate,e._endDate);e._objects.getTimeRangeSlider().setRange([i,j]);}e.toggleGroupTypeSelector(e._rangeFilterType);e._objects.getTimeFilterSelect().setSelectedKey(e._rangeFilterType);e._objects.getTimeRangeSlider().setVisible(true);e._objects.getTimeRangeSlider().invalidate();}).catch(function(){E.setBusy(false);z();});e._filterState.range=true;}},E=new V(e.getId()+"-filterContent",{confirm:function(G){var H=G.getParameter("filterItems"),J,K,N,Q,U;e._currentFilterKeys=H.map(function(W){return{key:W.getProperty("key"),text:W.getProperty("text")};});if(e._objects.getTimestampFilterPicker().getVisible()){e._startDate=e._objects.getTimestampFilterPicker().getStartDate();e._endDate=e._objects.getTimestampFilterPicker().getEndDate();U=true;}else{J=e._objects.getTimeRangeSlider();Q=J.getRange();K=J.getMin();N=J.getMax();e._startDate=null;e._endDate=null;if(Q[0]!==K||Q[1]!==N){e._startDate=e._fnAddDate(Math.min.apply(null,Q),D.DOWN);e._endDate=e._fnAddDate(Math.max.apply(null,Q),D.UP);U=true;}}e._filterData(U);},resetFilters:function(G){var H=e._objects.getTimeRangeSlider();H.setValue(H.getMin());H.setValue2(H.getMax());e._filterDialogRangePage.setFilterCount(0);},filterDetailPageOpened:function(G){var K=G.getParameter("parentFilterItem").getProperty("key");if(K==="items"){y(G.getParameter("parentFilterItem"));}if(K==="range"){A();}}});e._setupFilterFirstPage(E);return E;});};x.prototype._setupHeaderToolbar=function(){var e=this,i=function(y){e._objects.register(y.name,function(){var z=new f(e.getId()+"-"+y.name,{type:B.Transparent,icon:y.icon,tooltip:y.tooltip,press:y.fnPress});z.setLayoutData(new k({priority:y.priority}));return z;});};i({name:"filterIcon",icon:"sap-icon://add-filter",tooltip:t.getText("TIMELINE_FILTER_BY"),fnPress:[e._openFilterDialog,e],priority:m.NeverOverflow,visible:e.getShowItemFilter()||e.getShowTimeFilter()});i({name:"sortIcon",icon:"sap-icon://arrow-bottom",tooltip:t.getText("TIMELINE_SORT"),fnPress:[e._sortClick,e],priority:m.High,visible:e.getSort()&&e.getShowSort()});var j=new b();this._objects.register("searchFieldLabel",function(){return new o(e.getId()+"-searchFieldLabel",{text:t.getText("TIMELINE_ACCESSIBILITY_SEARCH")});});this._objects.register("searchField",function(){var y=new S(e.getId()+"-searchField",{width:"14rem",ariaLabelledBy:e._objects.getSearchFieldLabel().getId(),search:function(E){e._search(E.getSource().getValue());},visible:e.getShowSearch()});y.setLayoutData(new k({priority:m.Low}));return y;});this._objects.register("headerBar",function(){var y=[];if(e._isVertical()){y=[j,e._objects.getSearchFieldLabel(),e._objects.getSearchField(),e._objects.getSortIcon(),e._objects.getFilterIcon()];}else{y=[e._objects.getSortIcon(),e._objects.getFilterIcon(),e._objects.getSearchFieldLabel(),e._objects.getSearchField()];}var H=new O(e.getId()+"-headerBar",{content:y,visible:e.getShowHeaderBar()});H.addStyleClass("sapSuiteUiCommonsTimelineHeaderBar");H.setParent(e);return H;});};x.prototype._setupAccessibilityItems=function(){var e=this;this._objects.register("accessibilityTitle",function(){return new o(e.getId()+"-accessibilityTitle",{text:t.getText("TIMELINE_ACCESSIBILITY_TITLE")});});};x.prototype.toggleGroupTypeSelector=function(e){var i=e!==s.None;this._objects.getTimestampFilterPicker().setVisible(!i);this._objects.getTimeRangeSlider().setVisible(i);};}};return w;},true);
