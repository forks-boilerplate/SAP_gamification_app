var XLSXExportUtils=function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=33)}({33:function(e,t,r){var n=r(34),o=r(36);e.exports={oData:{fetch:n.requestData,getConverter:n.getConverter},saveFile:o.saveFile}},34:function(e,t,r){function n(e,t){return t.keys.reduce(function(e,t){return e&&e[t]},e)}function o(e,t){return t.forEach(function(t){e.forEach(function(e){e[t.property]=n(e,t)})}),e}function a(e){return e.workbook.columns.reduce(function(e,t){return(t.property instanceof Array?t.property:[t.property]).forEach(function(r){var n=r.split("/");n.length>1&&e.push({property:r,keys:n,type:t.type})}),e},[])}function i(e){var t=a(e);return function(e){return o(e,t)}}function s(e,t){function r(e,t,r){var n=URI.parse(h);if(r){var o=URI.parse(r);n.query=o.query}else{var a=(n.query||"").split("&"),i={};a.forEach(function(e){var t=e.split("=");t[0]&&(i[t[0]]=t[1])}),i.$skip=e,i.$top=t,a=[];for(var s in i)a.push(s+(null==i[s]?"":"="+i[s]));n.query=a.join("&")}return(URI.serialize||URI.build)(n)}function n(e){t({error:e})}function o(e){var i,c,p,h,v,y={};d||(i=e&&e.d&&(e.d.results||e.d)||e,i=Array.isArray(i)?i:[],p=i.length,s+=p,v=f-s,h=s/f,y.finished=0===p||v<=0,y.progress=Math.round(100*h),c=e&&e.d&&e.d.__next||null,y.finished||(a.dataUrl=r(s,Math.min(l,v),c),u.sendRequest(a).then(o).catch(n)),y.rows=x(i),t(y))}var a,s=0,p=e.dataSource,f=Math.min(p.count||c,c),l=Math.min(p.sizeLimit||c,e.batchSize||c,f),d=!1,h=p.dataUrl,x=i(e);return a={serviceUrl:function(e){if(!e)return"";var t=URI.parse(e);return t.path=t.path||"","/"!==t.path.slice(-1)&&(t.path=t.path+"/"),delete t.query,delete t.hash,delete t.fragment,(URI.serialize||URI.build)(t)}(p.serviceUrl),dataUrl:r(0,l),method:p.useBatch?"BATCH":"GET",headers:p.headers},u.sendRequest(a).then(o).catch(n),{cancel:function(){d=!0}}}var u=r(35),c=1e6;e.exports={requestData:s,getConverter:i}},35:function(e,t){function r(e){if("object"!=typeof e||null===e||"string"!=typeof e.dataUrl)throw new Error("Unable to send request - Mandatory parameters missing.");return("BATCH"===e.method&&e.serviceUrl?a:n)(e)}function n(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.onload=function(){if(this.status>=400)return void r(this.responseText);try{t(JSON.parse(this.responseText))}catch(e){r(s+this.responseText)}},n.onerror=function(){r(i)},n.onabort=function(){r(i)},n.open("GET",e.dataUrl,!0),n.setRequestHeader("accept","application/json"),n.send()})}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function a(e){return new Promise(function(t,r){var n=new XMLHttpRequest,a="batch_"+o(),u=e.dataUrl.split(e.serviceUrl)[1],c=[];n.onload=function(){for(var e=this.responseText,n=this.responseText.split("\r\n"),o=0,a=n.length,i=a-1;o<a&&"{"!==n[o].slice(0,1);)o++;for(;i>0&&"}"!==n[i].slice(-1);)i--;n=n.slice(o,i+1),e=n.join("\r\n");try{var u=JSON.parse(e);t(u)}catch(t){r(s+e)}},n.onerror=function(){r(i)},n.onabort=function(){r(i)},n.open("POST",e.serviceUrl+"$batch",!0),n.setRequestHeader("Accept","multipart/mixed"),n.setRequestHeader("Content-Type","multipart/mixed;boundary="+a);for(var p in e.headers)"accept"!=p.toLowerCase()&&n.setRequestHeader(p,e.headers[p]);c.push("--"+a),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push("GET "+u+" HTTP/1.1");for(var p in e.headers)c.push(p+":"+e.headers[p]);c.push(""),c.push(""),c.push("--"+a+"--"),c.push(""),c=c.join("\r\n"),n.send(c)})}var i="HTTP connection error",s="Unexpected server response:\n";e.exports={sendRequest:r}},36:function(e,t){function r(e,t){var r,n,o;e instanceof Blob&&(r=document.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in r,n&&(o=function(e,t){r.download=t,r.href=URL.createObjectURL(e),r.dispatchEvent(new MouseEvent("click"))}),void 0===o&&(o=function(t){var r=new FileReader;r.onloadend=function(){var e,t;t=r.result.replace(/^data:[^;]*;/,"data:attachment/file;"),(e=window.open(t,"_blank"))||(window.location.href=t)},r.readAsDataURL(e)}),"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&(o=function(e,t){window.navigator.msSaveOrOpenBlob(e,t)}),o(e,t))}e.exports={saveFile:r}}});
