/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(['jquery.sap.global','sap/m/MultiInput','sap/m/Bar','sap/m/Button','sap/m/ButtonType','sap/m/CheckBox','sap/m/Label','sap/m/LabelDesign','sap/m/Link','sap/m/List','sap/m/ListSeparators','sap/m/Panel','sap/m/PlacementType','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/Icon','sap/ui/core/TextAlign','sap/ui/core/Title','sap/ui/core/ValueState','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/ResponsiveFlowLayout','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/VerticalLayout','sap/ui/layout/form/Form','sap/ui/layout/form/FormContainer','sap/ui/layout/form/FormElement','sap/ui/layout/form/ResponsiveGridLayout','sap/ui/layout/form/FormRenderer','sap/ui/comp/util/IdentifierUtil','sap/m/library'],function(q,M,B,a,b,C,L,c,d,e,f,P,g,S,T,h,k,D,U,V,l,m,o,p,r,I,s,t,u,G,v,w,H,R,x,y,F,z,A,E,J,K,N){"use strict";var O;var Q;var W;var X;var Y;var Z=N.OverflowToolbarPriority;var $=N.ListMode;var _=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogCancel:{},filtersDialogSearch:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:v.render});_.INTERNAL_GROUP="__$INTERNAL$";_.prototype.init=function(){this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._bDoItOnce=false;this._oLabelTextWidth=0;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar");if(this._isPhone()){this.addStyleClass("sapUiCompFilterBarPhone");}else{this.addStyleClass("sapUiCompFilterBarNonPhone");}this.addStyleClass("sapUiCompFilterBarMarginBottom");this.addStyleClass("sapUiCompFilterBarPaddingPanel");this.addStyleClass("sapContrastPlus");this._oToolbar=this._createToolbar();this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oToolbar);this._oBasicAreaLayout=this._createBasicAreaLayout();this._oBasicAreaLayout.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new w({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._oAdvancedPanel.addContent(this._oAdvancedAreaForm);this.addContent(this._oAdvancedPanel);this._hResizeListener=sap.ui.core.ResizeHandler.register(this._oBasicAreaLayout,this._fHandleResize.bind(this));this.oModel=new sap.ui.model.json.JSONModel({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};_.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};_.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j&&this._mAdvancedAreaFilter){i=this._oBasicAreaLayout.indexOfContent(this._oHintText);if(i<0){this._oBasicAreaLayout.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);if(i<0){this._oBasicAreaLayout.rerender();}}};_.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var e1=this._mAdvancedAreaFilter[n];if(e1&&e1.items){for(i=0;i<e1.items.length;i++){j=e1.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};_.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);if(i&&this.getFilterBarExpanded()&&!this._isPhone()&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};_.prototype.getVariantManagement=function(){return this._oVariantManagement;};_.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}return this;};_.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}return this;};_.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};_.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};_.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};_.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};_.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};_.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};_.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton&&!this._isPhone()){this._oFiltersButton.setVisible(i);}return this;};_.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};_.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};_.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};_.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};_.prototype._getDataSuiteFormat=function(i,j){var n=null;var e1,f1,g1;if(this._oVariantManagement){e1=this.getCurrentVariantId();if(this.getFilterDataAsString){g1=this._determineVariantFiltersInfo(i,true);f1=this.getFilterDataAsString(i);if(f1){var h1=new l();n=h1.convert(e1,g1,f1,this,j);}}}return n;};_.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};_.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};_.prototype.setUiStateAsVariant=function(i){var j={replace:true,strictMode:true};this.setUiState(i,j);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(i.getSelectionVariant());};_.prototype._applyVisibility=function(i){var j=function(e1){if(e1&&e1.visible&&!e1.isHiddenFilter()){if(!e1.getVisibleInFilterBar()){e1.setVisibleInFilterBar(true);}if(!e1.getPartOfCurrentVariant()){e1.setPartOfCurrentVariant(true);}}};if(this._bIsInitialized){for(var n in this._mAdvancedAreaFilter){if(n){this._mAdvancedAreaFilter[n].items.forEach(function(e1){if(e1&&e1.filterItem&&e1.filterItem.getMandatory()){j(e1.filterItem);}else if(e1&&e1.filterItem){if(e1.filterItem.getVisibleInFilterBar()){e1.filterItem.setVisibleInFilterBar(false);}if(e1.filterItem.getPartOfCurrentVariant()){if(n===_.INTERNAL_GROUP){e1.filterItem.setPartOfCurrentVariant(true);}else{e1.filterItem.setPartOfCurrentVariant(false);}}}});}}if(i&&i.Parameters){i.Parameters.forEach(function(e1){var f1=this.determineFilterItemByName(e1.PropertyName);j(f1);}.bind(this));}if(i&&i.SelectOptions){i.SelectOptions.forEach(function(e1){var f1=this.determineFilterItemByName(e1.PropertyName);j(f1);}.bind(this));}}};_.prototype.getUiState=function(i){var j,n,e1=false,f1=null;if(i){e1=(i.allFilters===true);}n=this._getDataSuiteFormat(e1,"13.0");j=new U();j.selectionVariant=JSON.parse(n);j.setSelectionVariant(j.selectionVariant);if(j.getSelectionVariant()){if(this.getModelData&&this.getModelData()){f1=this.getModelData();}j.setValueTexts(U.calculateValueTexts(j.getSelectionVariant(),f1));}return j;};_.prototype.setUiState=function(i,j){var n,e1,f1=null,g1=false,h1=true;if(j){g1=(j.replace===true);h1=(j.strictMode===true);}if(i){f1=i.getSelectionVariant();if(f1){e1=JSON.stringify(f1);}n=i.getValueTexts();}this._setDataSuiteFormat(e1,g1,h1,n);};_.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};_.prototype._setDataSuiteFormat=function(i,j,n,e1){var f1,g1,h1;if(i){f1=new V();g1=f1.convert(i,this,n);if(g1){if(g1.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(g1.variantId,"DATA_SUITE");}else{this._setFilterVisibility(g1.variantId);}}this._oVariantManagement.setInitialSelectionKey(g1.variantId);}if(g1.payload&&(j||(Object.keys(JSON.parse(g1.payload)).length>0))&&this.setFilterDataAsString){h1=g1.payload;if(e1){h1=U.enrichWithValueTexts(h1,e1);}this.setFilterDataAsString(h1,j);}if(g1.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||g1.basicSearch);this._updateToolbarText();}}}};_.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.version==="V2"){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};_.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);};_.prototype._applyLayoutDataToToolbarButtons=function(i){if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}if(!O&&!this._bToolbarLayoutDataRequested){O=sap.ui.require("sap/m/ToolbarLayoutData");if(!O){sap.ui.require(["sap/m/ToolbarLayoutData"],a1.bind(this));this._bToolbarLayoutDataRequested=true;}}if(!O){return;}this._oHideShowButton.setLayoutData(new O({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new O({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new O({shrinkable:true}));this._oFiltersButton.setLayoutData(new O({shrinkable:true}));this._oSearchButton.setLayoutData(new O({shrinkable:false}));};function a1(i){O=i;this._bToolbarLayoutDataRequested=false;this._applyLayoutDataToToolbarButtons();}_.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};_.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};_.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};_.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};_.prototype.setSearchButtonEmphType=function(i){};_.prototype.setSimplifiedMode=function(i){};_.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};_.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);};_.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};_.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}}this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};_.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};_.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof p||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._updateToolbarText();}};_.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};_.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};_.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(i){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){if(!Q&&!this._bToolbarSeparatorRequested){Q=sap.ui.require("sap/m/ToolbarSeparator");if(!Q){sap.ui.require(["sap/m/ToolbarSeparator"],b1.bind(this));this._bToolbarSeparatorRequested=true;}}if(Q){this._oSeparator=new Q(this.getId()+"-HeadSep");}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem");}if(!this._oText){this._oText=new T(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight();}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText;}}}};function b1(i){Q=i;this._bToolbarSeparatorRequested=false;this._addHeaderToToolbar(this.getHeader());}_.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};_.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);this._oBasicAreaLayout.setVisible(true);if(this.getUseToolbar()){var j=this._oToolbar.getContent();for(var i=j.length-1;i>0;i--){this._oToolbar.removeContent(j[i]);}}else{if(this._oToolbar){this.removeContent(this._oToolbar);this._oToolbar.removeAllContent();this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}}};_.prototype._addButtonsToBasicArea=function(){var i=new y();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();j.setLayoutData(new x({margin:true}));i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();i.addStyleClass("sapUiCompFilterBarPaddingRight");if(this._isPhone()){i.addStyleClass("sapUiCompFilterBarRemoveMinWidth");this._oBasicAreaLayout.insertContent(i,0);}else{i.addStyleClass("sapUiCompFilterBarPaddingTop");this._oBasicAreaLayout.addContent(i);}this._oButtonsVLayout=i;};_.prototype._addBasicSearchToBasicArea=function(i){var n=null;if(this._oBasicSearchFieldContainer){if(this._oBasicSearchFieldContainer.$()){n=this._oBasicSearchFieldContainer.$().width();}if(!n){n=this._oBasicSearchFieldContainer.getWidth();}this._cleanBasicSearchContainer();}if(i){var j=new L({text:"\u2008"});j.addStyleClass("sapBasicSearchFilter");var e1=this._addControlToBasicAreaContainer(null,i,j);if(e1){e1.setVisible(true);var f1=0;if(this._isPhone()){f1=1;}this._oBasicAreaLayout.insertContent(e1,f1);this._oBasicSearchFieldContainer=e1;if(n){if(typeof n==='string'){this._oBasicSearchFieldContainer.setWidth(n);}else{this._oBasicSearchFieldContainer.setWidth(n+"px");}}}}};_.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};_.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(e1){j.fireFilterChange(e1);});}}}this._oBasicSearchField=i;return this;};_.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};_.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof k){return i;}}}return 0;};_.prototype.addFilterItem=function(i){var n,j,e1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var f1={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(f1);e1=new sap.ui.comp.filterbar.FilterGroupItem({label:i.getLabel(),labelTooltip:i.getLabelTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:_.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter()});if(i.data('isCustomField')){e1.data('isCustomField',true);}i.attachChange(this._filterItemChange.bind(this,null));this.addFilterGroupItem(e1);return this;};_.prototype.addFilterGroupItem=function(i){var n,j,e1,f1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}e1={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(e1);if(!i.getHiddenFilter()){f1=this._addControlToBasicAreaFormContainer(i);if(f1){e1.container=f1;f1.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange.bind(this));}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};_.prototype._addParameter=function(j){var i,n,e1,f1=false,g1=false,h1=_.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);n={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[h1]){this._mAdvancedAreaFilter[h1]={};this._mAdvancedAreaFilter[h1].filterItem=null;}if(!this._mAdvancedAreaFilter[h1].items){this._mAdvancedAreaFilter[h1].items=[];}for(i=0;i<this._mAdvancedAreaFilter[h1].items.length;i++){var i1=this._mAdvancedAreaFilter[h1].items[i];if(i1.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[h1].items.splice(i,0,n);f1=true;break;}if(!f1){this._mAdvancedAreaFilter[h1].items.push(n);if(Object.keys(this._mAdvancedAreaFilter).length>1){g1=true;}}e1=this._addControlToBasicAreaFormContainer(j);if(e1){n.container=e1;e1.setVisible(j.getVisible());}if(f1||g1){this._oBasicAreaLayout.removeContent(e1);this._addContainerInOrder(n.filterItem,n.container);}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};_.prototype._filterItemChange=function(i,j){var n;var e1;var f1;if(j&&j.oSource&&(j.oSource instanceof sap.ui.comp.filterbar.FilterItem)){f1=j.getParameter("propertyName");if(f1==="visibleInFilterBar"||f1==="visible"||f1==="label"||f1==="labelTooltip"||f1==="mandatory"){n=this._determineItemByName(j.oSource.getName(),_.INTERNAL_GROUP);if(n&&n.filterItem){if((f1==="visible")){e1=j.oSource.getVisible();n.filterItem.setVisible(e1);}else if(f1==="visibleInFilterBar"){e1=j.oSource.getVisibleInFilterBar();var g1=this._checkChangePossibleVisibleInFilterBar(n.filterItem,e1);if(g1){n.filterItem.setVisibleInFilterBar(e1);}else{j.oSource.setVisibleInFilterBar(true);}}else if(f1==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(f1==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(f1==="mandatory"){e1=j.oSource.getMandatory();n.filterItem.setMandatory(e1);}}}}};_.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var e1=i.oSource.getVisibleInFilterBar();var f1=this._checkChangePossibleVisibleInFilterBar(i.oSource,e1);if(!f1){i.oSource.setVisibleInFilterBar(true);e1=true;}if(e1){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()&&!this._oDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}else if((n==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var g1=this.determineFilterItemByName(i.oSource.getName());if(g1&&g1.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()){this._rerenderAA();}}};_.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};_.prototype._addContainerInOrder=function(j,e1){var n,i,f1,g1=this._oBasicAreaLayout.getContent(),h1=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){h1++;}if(this._oBasicSearchField){h1++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var i1=this._mAdvancedAreaFilter[n];if(i1&&i1.items){for(i=0;i<i1.items.length;i++){if(!i1.items[i].container){continue;}if(i1.items[i].container===e1){this._oBasicAreaLayout.insertContent(e1,h1+1);return;}f1=g1.indexOf(i1.items[i].container);if(f1>=0){h1=f1;}}}}}};_.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};_.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};_.prototype._hasFilterValue=function(i){var j=this._getFiltersWithValues();return this._checkFilterForValue(j,i);};_.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var e1=true;if(i.getMandatory()){var f1=this._hasFilterValue(i);if(!f1){e1=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(e1);}}};_.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};_.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};_.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==_.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};_.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};_.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};_.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};_.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};_.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};_.prototype.variantsInitialized=function(){this.fireInitialized();};_.prototype.fireInitialized=function(){this.fireEvent("initialized");};_.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};_.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");}catch(i){q.sap.log.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};_.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};_.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};try{this.fireEvent("afterVariantLoad",n);}catch(ex){q.sap.log.error("error during 'afterVariantLoad' event handling - "+ex.message);}};_.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};_.prototype.removeAllFilterItems=function(){var i;var j=[];this._aBasicAreaSelection=null;var n=this._oBasicAreaLayout.getContent();if(n){for(i=0;i<n.length;i++){this._oBasicAreaLayout.removeContent(n[i]);}}if(this._mAdvancedAreaFilter){if((this._mAdvancedAreaFilter[_.INTERNAL_GROUP])&&(this._mAdvancedAreaFilter[_.INTERNAL_GROUP].items)){for(i=0;i<this._mAdvancedAreaFilter[_.INTERNAL_GROUP].items.length;i++){if(this._mAdvancedAreaFilter[_.INTERNAL_GROUP].items[i].filterItem){j.push(this._mAdvancedAreaFilter[_.INTERNAL_GROUP].items[i].filterItem);}}delete this._mAdvancedAreaFilter[_.INTERNAL_GROUP];}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this._destroyItems(j);this._adaptButtonsEnablement();return j;};_.prototype.removeAllFilterGroupItems=function(){var n=null,i;var j=[];for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){if(this._mAdvancedAreaFilter[n].items[i].filterItem){j.push(this._mAdvancedAreaFilter[n].items[i].filterItem);}}delete this._mAdvancedAreaFilter[n];}}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this.__bDeleteMode=true;this._destroyItems(j);this.__bDeleteMode=false;this._adaptButtonsEnablement();return j;};_.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};_.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};_.prototype.getAllFilterItems=function(j){var i,n=null;var e1=[];var f1,g1;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){f1=this._mAdvancedAreaFilter[n];if(f1.items){for(i=0;i<f1.items.length;i++){g1=f1.items[i];if(g1&&g1.filterItem&&g1.filterItem.getVisible()){if(j){if(g1.filterItem.getVisibleInFilterBar()||g1.filterItem.getPartOfCurrentVariant()){e1.push(g1.filterItem);}}else{e1.push(g1.filterItem);}}}}}}}return e1;};_.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};_.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};_.prototype._getFilterInformation=function(){return[];};_.prototype._createVisibleFilters=function(){this._getFilters();};_.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[_.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[_.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[_.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==_.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===_.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};_.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===_.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};_.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};_.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};_.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(n){if(n.factory){if(n.isCustomFilterField&&!n.visibleInAdvancedArea){j.push(n.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(n.fieldName,n.groupName)){j.push(n.fieldName);}});return j;};_.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,e1;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){e1=this._mAdvancedAreaFilter[j].items[i];if(e1.filterName&&(e1.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(e1.filterItem);}}}return false;};_.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};_.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],n=this.getAllFilterItems();if(n){n.forEach(function(e1){if(i._isNonVisibleCustomFilterNamesByFilter(e1)){j.push(e1.getName());}});}return j;};_.prototype._ensureFilterLoaded=function(n){var i,j,e1;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){e1=this._aFields[j];if(!e1.factory){continue;}if(n){for(i=0;i<n.length;i++){if((e1.fieldName===n[i].name)&&(e1.groupName===n[i].group)){this._instanciateFilterItem(e1);break;}}}else{this._instanciateFilterItem(e1);}}if(!n){this._aFields=[];}}};_.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};_.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};_.prototype._reapplyVisibility=function(j){var i,n=null;var e1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var f1=this._mAdvancedAreaFilter[n];if(f1&&f1.items){for(i=0;i<f1.items.length;i++){e1=f1.items[i];if(e1&&e1.filterItem){this._setPersVisibility(j,e1.filterItem);}}if(n!==_.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};_.prototype._setPersVisibility=function(i,j){var n,e1;var f1;if(j&&!j.getHiddenFilter()){e1=j.getName();n=j.getGroupName();f1=this._checkForFilterInfo(i,e1,n);if(this._isTINAFScenario()){if(f1){j.setVisibleInFilterBar(f1.visibleInFilterBar);j.setPartOfCurrentVariant(f1.partOfCurrentVariant);if(f1.hasOwnProperty("visible")){j.setVisible(f1.visible);}}else{j.setVisibleInFilterBar(false);if((n===_.INTERNAL_GROUP)||j._isParameter()){j.setPartOfCurrentVariant(true);}else{j.setPartOfCurrentVariant(false);}}}else{if(f1&&(f1.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((f1.visibleInFilterBar));j.setPartOfCurrentVariant((f1.partOfCurrentVariant));}else{if((n!==_.INTERNAL_GROUP)&&f1&&(f1.group===n)){j.setVisibleInFilterBar((f1!==null));}}}if(n===_.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}if(j){var g1=this.determineControlByFilterItem(j,true);if(g1&&g1.getValueState&&(g1.getValueState()!==u.None)){g1.setValueState(u.None);}}}};_.prototype._checkForFilterInfo=function(j,n,e1){var i;var f1=null;if(j&&j.length){for(i=0;i<j.length;i++){if(j[i].name===n){if((j[i].group===e1)){f1=j[i];break;}}}}return f1;};_.prototype._createVariantManagement=function(){var i=new p(this.getId()+"-variantUi2",{});var j=new o({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};_.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};_.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,e1=this.retrieveFiltersWithValues(),f1,g1=this.getBasicSearchValue();if(g1&&e1){e1.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"));}if(!e1||(e1.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){f1=Math.min(5,e1.length);n="";for(var i=0;i<f1;i++){n+=e1[i];if(i<(f1-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[e1.length,n]);if(f1<e1.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[e1.length]);}}return j;};_.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};_.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){q.sap.log.error("callback for obtaining the filter count throws an exception");}}return null;};_.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};_.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};_.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof k){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};_.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};_.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var j=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var e1=n?(this._oRb.getText(i,[n])):(this._oRb.getText(j));this._oFiltersButton.setText(e1);this._oFiltersButton.setTooltip(e1);this.fireAssignedFiltersChanged();};_.prototype.setFilterBarExpanded=function(i){var j;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}this._calcVisibilityGoButton();this._oAdvancedPanel.setVisible(i);}else{if(this._isPhone()&&this.getUseToolbar()){j=false;}else{j=i;}this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();};_.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};_.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var e1=n.filterItem;if(!e1.getMandatory()){return;}var f1=this._hasFilterValue(e1);if(e1.getVisibleInFilterBar()){if(f1){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!f1){e1.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};_.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();var j=this._retrieveVisibleAdvancedItems();if(this._oAddToFilterBarLabel){if(!j||(j.length<=0)){this._oAddToFilterBarLabel.setVisible(false);}else{this._oAddToFilterBarLabel.setVisible(true);}}this._setConsiderFilterChanges(true);return i;};_.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,e1;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){e1=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!e1.getVisible()||e1.getHiddenFilter()){continue;}if(!e1.getPartOfCurrentVariant()&&!e1.getVisibleInFilterBar()){n++;}}}return n;};_.prototype._rerenderGroup=function(j,n){var i;var e1;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){e1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(e1&&e1.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};_.prototype._setLinkTextAndCount=function(i,j,n){var e1;if(n){e1=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{e1=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(e1);};_.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};_.prototype._createLink=function(i,j){var n,e1=this;n=K.replace(i);var f1=new d(this.getId()+"-link-"+n);this._setLinkText(i,f1);f1.attachPress(function(){e1._createAddRemoveFiltersDialog(i,f1);});if(j){f1.addAriaLabelledBy(j);}return f1;};_.prototype._isPhone=function(){return(D.system.phone)?true:false;};_.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};_.prototype._createForm=function(i){var j=this;var n=null;n=F.extend('sap.ui.comp.filterbar.Form',{metadata:{},renderer:function(e1,f1){J.render.apply(this,arguments);}});(function(){n.prototype.contentOnAfterRendering=function(){F.prototype.contentOnAfterRendering.apply(this,arguments);j._adaptStyleSheet();if(j._oFilterDialog&&j._oFilterDialog.isOpen()&&(j._isNewFilterBarDesign()||!j._isPhone())){j._repositionAddToFilterBarLabel();}};}());return new n({editable:true,layout:i});};_.prototype._adaptStyleSheet=function(){var i,j;var e1,f1,n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){e1=this._mAdvancedAreaFilter[n].items[i];if(e1&&e1.control&&e1.control instanceof M){f1=e1.control.$();if(f1){j=f1.parent().css("overflow");if(j!=="visible"){f1.parent().css({"overflow":"visible"});}}}}}}};_.prototype._addFieldToFiltersDialog=function(i,j,n){var e1,f1,g1,h1;if(!i&&!i.filterItem||i.filterItem.getHiddenFilter()){return;}var i1=this._determineVisibility(i.filterItem);if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}e1=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){e1.setText(i.filterItem.getLabel());}f1=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});f1.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){h1=this._checkFilterForValue(n,i.filterItem);if(!h1&&i.filterItem.getVisibleInFilterBar()){f1.setEnabled(false);}}f1.attachSelect(this._selectionChangedInFilterDialog.bind(this,f1,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){i.control.setLayoutData(new w({span:"L8 M8 S11"}));f1.setLayoutData(new w({span:"L1 M1 S1"}));}else{i.control.setLayoutData(new w({span:"L8 M8 S12"}));f1.setVisible(false);}g1=new A({label:e1,fields:[i.control,f1]});g1.setVisible(i1);i.formelement=g1;i.checkbox=f1;j.addFormElement(g1);};_.prototype._createHeaderAddToFilterBar=function(i){var j,n;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L({});j.setLayoutData(new w({span:"L10 M10"}));j.addStyleClass("sapUiCompFilterBarAddFilterLabel");this._oAddToFilterBarLabel=j;n=new A({label:j,fields:[]});i.addFormElement(n);j.setLabelFor(null);}};_.prototype._addBasicSearchAddToFilterBar=function(i){var j;if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S11",indent:"L3 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){j=new A({fields:[this._oBasicSearchFieldClone]});}else{j=new A({fields:[this._oBasicSearchField]});}i.addFormElement(j);};_.prototype._isGroupEmpty=function(i){var j=true;i.some(function(n){if(n.filterItem&&n.filterItem.getVisible()&&!n.filterItem.getHiddenFilter()){j=false;return true;}return false;});return j;};_.prototype._createFilters=function(){var j=this,n=null,i,e1;var f1=null,g1,h1,i1;var j1,k1,l1=true,m1;this._oClonedVM=null;var n1=new E();n1.setColumnsL(1);n1.setLabelSpanL(3);n1.setColumnsM(1);n1.setLabelSpanM(3);var o1=this._createForm(n1);o1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var p1=this._oToolbar.indexOfContent(this._oVariantManagement);if(p1>=0){this._oClonedVM=this._oVariantManagement.clone();this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);f1=new z();this._oVariantManagement.setLayoutData(new w({span:"L10 M10 S12"}));g1=new A({fields:this._oVariantManagement});f1.addFormElement(g1);o1.addFormContainer(f1);}o1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField&&!this._isNewFilterBarDesign()){if(!f1){f1=new z();o1.addFormContainer(f1);}this._addBasicSearchAddToFilterBar(f1);}this._ensureFilterLoaded(null);var q1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(r1){j._mandatoryFilterChange(r1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};q.extend(true,this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===_.INTERNAL_GROUP){e1=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{e1=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}k1=new t({text:e1});f1=new z({title:k1});if(l1&&!this._isGroupEmpty(this._mAdvancedAreaFilter[n].items)){l1=false;this._createHeaderAddToFilterBar(f1);if(this._oBasicSearchField&&this._isNewFilterBarDesign()){this._addBasicSearchAddToFilterBar(f1);}}m1=0;this._mAdvancedAreaFilter[n].formcontainer=f1;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){i1=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(i1,f1,q1);if(!i1.filterItem.getVisible()){m1++;}}h1=f1.getFormElements();if(h1&&h1.length>0){if((n!==_.INTERNAL_GROUP)&&!this.getAdvancedMode()){j1=this._createLink(n,k1);if(j1){if(this._isPhone()){j1.setLayoutData(new w({span:"L8 M8 S12"}));}else{j1.setLayoutData(new w({span:"L8 M8 S12",indent:"L3 M3 S0"}));}g1=new A({fields:[j1]});this._mAdvancedAreaFilter[n].link=j1;f1.addFormElement(g1);}if(m1===h1.length){f1.setVisible(false);}}o1.addFormContainer(f1);}}}return o1;};_.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};_.prototype._recreateBasicAreaContainer=function(j){var n=null,i;var e1,f1;var g1,h1,i1;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var j1=this._oBasicAreaLayout.removeAllContent();if(!j){if(j1){var k1=j1.length;var l1=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){l1++;}else{k1--;}}for(i=l1;i<k1;i++){if(j1[i]!==this._oHintText){j1[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){g1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(g1.getHiddenFilter()){continue;}i1=null;if(j){if(!g1.getVisible()||!g1.getVisibleInFilterBar()){continue;}h1=this._mAdvancedAreaFilter[n].items[i].container;if(h1){if(h1.$()&&h1.$().width()){i1=h1.$().width();}h1.removeAllContent();h1.destroy();}e1=this._mAdvancedAreaFilter[n].items[i].control.clone();f1=g1.getLabelControl(this.getId()).clone();f1.setLabelFor(null);if(this.getConsiderGroupTitle()){g1.getLabelControl(this.getId()).setText(g1.getLabel());}}else{e1=this._mAdvancedAreaFilter[n].items[i].control;f1=g1.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){e1.setWidth(this._mAdvancedAreaFilter[n].items[i].width);}}h1=this._addControlToBasicAreaContainer(g1,e1,f1);if(h1){h1.setVisible(g1.getVisible()&&g1.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=h1;if(j&&i1){h1.setWidth(i1+"px");}}}}}};_.prototype._searchRequested=function(){var i,j=false;if(this.verifySearchAllowed){i=this.verifySearchAllowed();if(i.hasOwnProperty("pending")){return;}else if(i.hasOwnProperty("error")||i.hasOwnProperty("mandatory")){j=true;}}if(j){this._bOKFiltersDialogTriggered=false;if(this._oFiltersSearchField.getValue()){this._resetFilterBarSearch();}this._activateMainContent();}else{this._bOKFiltersDialogTriggered=true;if(!this.isLiveMode||!this.isLiveMode()){this.search();}else{this._oFilterDialog.close();}}};_.prototype._activateMainContent=function(){var i=this.getFilterDialogContent();if(i&&(i.length>1)){this.addFilterDialogContent(i[0]);}};_.prototype.fireSearch=function(i){if(this._oFilterDialog&&this._bOKFiltersDialogTriggered){this._oFilterDialog.close();}this.fireEvent("search",i);};_.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this.isLiveMode&&this.isLiveMode()){this.search();}this._updateToolbarText();};_.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};_.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};_.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};_.prototype._findFirstVisibleGroup=function(){var n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].formcontainer&&this._mAdvancedAreaFilter[n].formcontainer.getVisible()){return this._mAdvancedAreaFilter[n].formcontainer.getTitle();}}return null;};_.prototype._checkForCollision=function(i,j){var n=this._oFilterDialog.getDomRef("scroll");this._oLabelTextWidth=Math.max(j.width(),this._oLabelTextWidth);if(!this._oLabelTextWidth){return false;}if(!(i.position()&&i.width())){return false;}if(sap.ui.getCore().getConfiguration().getRTL()){if((this._oLabelTextWidth>0)&&n&&((n.clientWidth-this._oLabelTextWidth-32)<i.position().left)){return false;}}else{if((this._oLabelTextWidth>0)&&n&&(i.position().left+i.width())>=(n.clientWidth-this._oLabelTextWidth-32)){return false;}}return false;};_.prototype._repositionAddToFilterBarLabel=function(){if(this._isNewFilterBarDesign()||!this._isPhone()&&this._oAddToFilterBarLabel.getVisible()){var i=this._findFirstVisibleGroup();if(i&&this._oAddToFilterBarLabel){var j=i.$();if(j){var n=this._oAddToFilterBarLabel.$();if(n){j.css({display:"inline"});if(this._checkForCollision(j,n)){this._oAddToFilterBarLabel.setVisible(false);return;}var e1=j.offset();var f1=n.offset();if(f1&&e1){f1.top=Math.ceil(e1.top);n.offset(f1);if(!sap.ui.getCore().getConfiguration().getRTL()){n.css({left:"auto"});}}}}}if(this._oAddToFilterBarLabel&&!this._oAddToFilterBarLabel.getText()){this._oAddToFilterBarLabel.setText(this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR"));}}};_.prototype._filterSetInErrorState=function(i){if(this._oFilterDialog&&this._oFilterDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};_.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};_.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(i){if(i.control&&i.control.setValueState&&i.control.getValueState){if(i.control.getValueState()===u.Error){if(i.control.setValue){i.control.setValue("");}i.control.setValueState(u.None);}}});};_.prototype.showFilterDialog=function(){if(!this._oFilterDialog){this._showFilterDialog();}};_.prototype.addFilterDialogContent=function(i){if(this._oFilterDialog&&i){var n=this._oFilterDialog.indexOfContent(i);if(n<0){this._oFilterDialog.addContent(i);}return this._setFilterDialogActiveContent(i);}return null;};_.prototype.getFilterDialogContent=function(){if(this._oFilterDialog){return this._oFilterDialog.getContent();}return null;};_.prototype._setFilterDialogActiveContent=function(n){var i=false;if(this._oFilterDialog){this.getFilterDialogContent().forEach(function(j){if(n===j){j.setVisible(true);i=true;}else{j.setVisible(false);}});if(i){return n;}}return null;};_.prototype._getFilterDialogActiveContent=function(){var i=null;if(this._oFilterDialog){this.getFilterDialogContent().some(function(j){if(j.getVisible()){i=j;return true;}return false;});}return i;};_.prototype.setContentWidth=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentWidth(n+"px");}};_.prototype.setContentHeight=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentHeight(n+"px");}};_.prototype._showFilterDialog=function(){if((!X||!W)&&!this._bDialogRequested){X=sap.ui.require("sap/m/Dialog");W=sap.ui.require("sap/m/OverflowToolbarLayoutData");if(!X){sap.ui.require(["sap/m/Dialog","sap/m/OverflowToolbarLayoutData"],c1.bind(this));this._bDialogRequested=true;}}if(!X||!W){return;}var i=this;this._oFilterDialog=new sap.m.Dialog(this.getId()+"-adapt-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oFilterDialog.isPopupAdaptationAllowed=function(){return false;};this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}var j="FILTER_BAR_ADV_FILTERS_DIALOG";if(this._isNewFilterBarDesign()){j="FILTER_BAR_ADAPT_FILTERS_DIALOG";}this._oFilterDialog.setTitle(this._oRb.getText(j));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var n=new B();this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});n.addContentRight(this._oFiltersSearchField);this._oFilterDialog.setSubHeader(n);var e1=this._createFiltersAndAdaptBasicArea();if(!e1){q.sap.log.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(e1);this._oFiltersSearchField.attachLiveChange(function(f1){if(this._oFilterDialog){this.fireFiltersDialogSearchForFilters(f1.getParameters());this._triggerSearchInFilterDialog(f1);}}.bind(this));this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog.bDoNotAddToBasicArea=true;this._oFilterDialog.attachBeforeOpen(function(){this.fireFiltersDialogBeforeOpen();}.bind(this));this._oFilterDialog.attachAfterOpen(function(){if(!this._isPhone()&&(e1===this._getFilterDialogActiveContent())){var f1=i._oFilterDialog.getDomRef("scroll");if(f1){this.setContentWidth(f1.clientWidth);this.setContentHeight(f1.clientHeight);}}}.bind(this));this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog(i._bVariantSaveFiltersDialogTriggered);}delete i._oFilterDialog.bDoNotAddToBasicArea;i._closeDialogAndRestoreFilterBar(e1);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();var f1={};f1.context=i._bOKFiltersDialogTriggered?"SEARCH":"CANCEL";i.fireFiltersDialogClosed(f1);if(i._isNewFilterBarDesign()){i._fHandleResize();}});this._oFilterDialog.setInitialFocus(this._oFiltersSearchField);this._addFilterDialogButtons(e1);this._bDirtyViaDialog=false;this._oFilterDialog.open();};function c1(i,j){X=i;W=j;this._bDialogRequested=false;this._showFilterDialog();}_.prototype.isDialogOpen=function(){return this._oFilterDialog?true:false;};_.prototype._addFilterDialogButtons=function(i){var j=this;var n;var e1=null,f1,g1,h1,i1;h1=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){h1.focus();j._dialogSearch(i);},layoutData:new W({priority:Z.NeverOverflow}),type:b.Emphasized});this._oFilterDialog.addButton(h1);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){e1=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._dialogVariantSave(i);},layoutData:new W({priority:Z.Low})});n=this._oVariantManagement.getModel("save_enablement");e1.setModel(n);e1.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(e1);}}f1=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j._dialogClear(i);},layoutData:new W({priority:Z.Low})});this._oFilterDialog.addButton(f1);g1=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j._dialogRestore(i);},layoutData:new W({priority:Z.Low})});if(n){g1.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());g1.setModel(n);g1.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(g1);i1=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._dialogCancel(i);},layoutData:new W({priority:Z.High})});this._oFilterDialog.addButton(i1);}};_.prototype._dialogSearch=function(i){this.fireFiltersDialogSearch();this._searchRequested();};_.prototype._dialogCancel=function(i){if(this._oFilterDialog){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();this._oFilterDialog.close();}};_.prototype._dialogVariantSave=function(i){this._bVariantSaveFiltersDialogTriggered=true;this._variantSavePressed();};_.prototype._dialogRestore=function(i){this.reset();if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false);}};_.prototype._dialogClear=function(i){this.clear();};_.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:b.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:b.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:b.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration()||this._isPhone(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),tooltip:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:b.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._oFiltersButton.focus();j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),tooltip:this._oRb.getText("FILTER_BAR_GO"),type:b.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};_.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};_.prototype._createToolbar=function(i){var j=new h(this.getId()+"-toolbar");if(!i){var n=this._createVariantLayout();j.addContent(n);}j.addContent(new k());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");j.addStyleClass("sapUiCompFilterBarToolbarMarker");return j;};_.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};_.prototype._createBasicAreaLayout=function(){var i=new H({visible:false});i.setAllowWrapping(true);i.addStyleClass("sapUiCompFilterBarWidth100");i.addStyleClass("sapUiCompFilterBarBasicArea");return i;};_.prototype._createAdvancedAreaForm=function(){var i=new E();i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new F({editable:true});j.setLayout(i);return j;};_.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){q.sap.log.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){q.sap.log.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};_.prototype._addControlToBasicAreaContainer=function(i,j,n){var e1=new y();e1.setLayoutData(new x({margin:true}));if(j.setWidth){j.setWidth("100%");}e1.setWidth(this.getFilterContainerWidth());if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}e1.addContent(n);if(n.setLabelFor){if(i&&j){n.setLabelFor(j);}}}e1.addContent(j);e1.addStyleClass("sapUiCompFilterBarPaddingRight");e1.addStyleClass("sapUiCompFilterBarPaddingTop");if(!this.getAdvancedMode()&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("bDoNotAddToBasicArea")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){if(this._isNewFilterBarDesign()){var f1=this._oBasicAreaLayout.getContent();if(this._isPhone()){this._oBasicAreaLayout.addContent(e1);}else{this._oBasicAreaLayout.insertContent(e1,f1.length-1);}}else{this._oBasicAreaLayout.addContent(e1);}}}return e1;};_.prototype._rerenderAA=function(){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);};_.prototype._layOutAA=function(i){if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};_.prototype._layOutAAMultipleGroup=function(n){var i,j,e1=0;var f1=null;for(i=0;i<n.length;i++){if(n[i].control===null){e1++;}}var g1=this._oAdvancedAreaForm.getLayout();if(g1){if(e1>=3){g1.setLabelSpanL(5);g1.setLabelSpanM(5);g1.setColumnsL(3);g1.setColumnsM(2);}else if(e1===2){g1.setLabelSpanL(4);g1.setLabelSpanM(5);g1.setColumnsL(2);g1.setColumnsM(2);}else if(e1===1){g1.setLabelSpanL(4);g1.setLabelSpanM(5);g1.setColumnsL(2);g1.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){f1=new z();if(Object.keys(this._mAdvancedAreaFilter).length>1){f1.setTitle(n[i].filterItem.getGroupTitle());}this._oAdvancedAreaForm.addFormContainer(f1);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,f1);j++;}i=j-1;}}if(e1===1){this._oAdvancedAreaForm.addFormContainer(new z());}};_.prototype._layOutAASingleGroup=function(j){var i,n,e1,f1;var g1=j.length-1;var h1=g1>2?2:1;if(h1>1){e1=Math.floor(g1/h1);f1=((e1*h1)<g1);for(i=1;i<h1;i++){n=i*e1;if(f1){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};_.prototype._flattenMap=function(){var n=null,i;var j=[];var e1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){e1=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var f1=this._mAdvancedAreaFilter[n].items[i];if(f1.filterItem&&f1.filterItem.getVisibleInFilterBar()&&f1.filterItem.getVisible()&&!f1.filterItem.getHiddenFilter()){if(!e1){e1=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:f1.control,filterItem:f1.filterItem});}}}}}return j;};_.prototype._triggerSearchByValue=function(j){var i,n,e1;var f1;var g1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){var h1=0;for(i=this._aListItems.length-1;i>=0;i--){f1=this._aListItems[i].getContent();if(f1&&(f1.length>0)){n=f1[0].getText();e1=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(e1&&e1.toLowerCase().indexOf(j)>=0))||(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")&&h1>0)){g1=true;if(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")){if(!h1){g1=false;}}else{h1++;}this._aListItems[i].setVisible(g1);}else{this._aListItems[i].setVisible(false);}}}}};_.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};_.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i;var e1;var f1,g1;var h1;var i1;var j1=true;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){f1=this._mAdvancedAreaFilter[n];if(f1&&f1.items){h1=0;i1=0;for(i=0;i<f1.items.length;i++){if(f1.items[i]&&f1.items[i].filterItem){g1=f1.items[i].filterItem;if(g1.getHiddenFilter()){++h1;continue;}if(g1.getVisible()){if(j&&f1.items[i].formelement){e1=g1.getLabel();if(e1.toLowerCase().indexOf(j)>=0){if(g1.getPartOfCurrentVariant()){f1.items[i].formelement.setVisible(true);}else{++i1;}}else{++h1;f1.items[i].formelement.setVisible(false);}}else if(f1.items[i].formelement){f1.items[i].formelement.setVisible(g1.getVisibleInFilterBar()||g1.getPartOfCurrentVariant());if(f1.link&&!f1.link.getVisible()){f1.link.setVisible(true);}}}else{++h1;}}}if(f1&&f1.formcontainer){if(h1===f1.items.length){f1.formcontainer.setVisible(false);}else{j1=false;f1.formcontainer.setVisible(true);if(f1.link){f1.link.setVisible((j&&(i1===0))?false:true);if(j&&(i1>0)){this._setLinkTextAndCount(n,f1.link,i1);}else{this._setLinkText(n,f1.link);}}}}}}}}if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setVisible(!j1);}};_.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};_.prototype._generateListItems=function(j,n){if(!Y){Y=sap.ui.require("sap/m/CustomListItem");if(!Y){throw new Error("_generateListItems msut only be called via _createAddRemoveFiltersDialog "+this);}}var i;var e1,f1;var g1;var h1=false;if(this.$().closest(".sapUiSizeCompact").length>0){h1=true;}if(j&&this._mAdvancedAreaFilter){f1=this._mAdvancedAreaFilter[j];if(f1&&f1.items){for(i=0;i<f1.items.length;i++){var i1=f1.items[i];if(i1&&i1.filterItem){if(!i1.filterItem.getVisible()||i1.filterItem.getHiddenFilter()){continue;}e1=new Y();e1.setVisible(true);if(!h1){e1.addStyleClass("sapUiCompFilterBarListItem");}else{e1.addStyleClass("sapUiCompFilterBarListItemCompact");}e1.data("quickinfo",i1.filterItem.getLabelTooltip());i1.initialPartOfCurrentVariant=i1.filterItem.getPartOfCurrentVariant();i1.initialVisibleInFilterBar=i1.filterItem.getVisibleInFilterBar();e1.data('item',i1);g1=new L({text:i1.filterItem.getLabel(),tooltip:i1.filterItem.getLabelTooltip()});e1.addContent(g1);n.addItem(e1);if(i1.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(e1);}if(i1.filterItem.getMandatory()&&i1.checkbox&&!i1.checkbox.getEnabled()){e1.getModeControl().setEnabled(false);}}}}}var j1=this;n.attachSelectionChange(function(k1){if(k1){var l1=k1.getParameters();if(l1){var e1=l1.listItem;if(e1){var m1=e1.getModeControl();var i1=e1.data('item');j1._selectionChangedInAddFiltersDialog(m1,i1);}}}});};_.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};_.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};_.prototype.rerenderFilters=function(){this._rerenderFilters();};_.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};_.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};_.prototype._createAddRemoveFiltersDialog=function(j,n){var i,e1=this;if(!j){return;}if((!X||!Y)&&!this._bCustomListItemRequested){Y=sap.ui.require("sap/m/CustomListItem");X=sap.ui.require("sap/m/Dialog");if(!X||!Y){sap.ui.require(["sap/m/Dialog","sap/m/CustomListItem"],d1.bind(this));this._bCustomListItemRequested=true;this._oFiltersDialogData={groupName:j,link:n};}}if(!X||!Y){return;}this._oDialog=new sap.m.Dialog(this.getId()+"-set-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var f1=new B();var g1=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=g1;g1.attachLiveChange(function(k1){e1._triggerSearch(k1);});f1.addContentRight(g1);this._oDialog.setSubHeader(f1);var h1=new e({mode:$.MultiSelect});h1.setShowSeparators(f.None);this._oDialog.addContent(h1);this._generateListItems(j,h1);this._aListItems=h1.getItems();for(i=0;i<this._aListItems.length;i++){h1.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var i1=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK")});i1.attachPress(function(){e1._bOKButtonAddRemoveFilterDialogTriggered=true;e1._oDialog.close();});this._oDialog.addAggregation("buttons",i1);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var j1=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){e1._oDialog.close();}});this._oDialog.addAggregation("buttons",j1);this._oDialog.attachBeforeClose(function(){if(!e1._bOKButtonAddRemoveFilterDialogTriggered){e1._cancelAddRemoveFiltersDialog(j);}e1.rerenderFilters();e1._closeAddRemoveFiltersDialog(j,n);if(e1._oFilterDialog){e1._oFilterDialog.invalidate();}});this._oDialog.attachAfterClose(function(){this._aListItems=null;e1._oDialog.destroy();e1._oDialog=null;});this._oDialog.open();};function d1(i,j){X=i;Y=j;this._bCustomListItemRequested=false;this._createAddRemoveFiltersDialog(this._oFiltersDialogData.groupName,this._oFiltersDialogData.link);delete this._oFiltersDialogData;}_.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);this._notifyAboutChangedFilters(n,j.control);};_.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};_.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};_.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};_.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};_.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);if(this._isNewFilterBarDesign()){}};_.prototype._notifyAboutChangedFilters=function(i,j){var n,e1=this._determineByControl(j);if(i){n={"added":j,"filterItem":e1};}else{n={"deleted":j,"filterItem":e1};}this.fireFilterChange(n);};_.prototype._determineVariantFiltersInfo=function(j,e1){var i;var n=null,f1,g1;var h1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){f1=this._mAdvancedAreaFilter[n].items[i];if(j||f1.filterItem.getVisible()){g1={group:f1.filterItem.getGroupName(),name:f1.filterItem.getName(),partOfCurrentVariant:f1.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:f1.filterItem.getVisibleInFilterBar(),visible:f1.filterItem.getVisible()};if(e1||this._considerFilter(g1)){h1.push(g1);}}}}}}}return h1;};_.prototype.mergeVariant=function(i,j){var n={};q.extend(true,n,j);n.filterbar=[];n.filterBarVariant={};q.extend(true,n.filterbar,i.filterbar);q.extend(true,n.filterBarVariant,i.filterBarVariant);if(j&&j.version==="V2"){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};_.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(e1){for(i=0;i<j.length;i++){if((j[i].group===e1.group)&&(j[i].name===e1.name)){j.splice(i,1);break;}}});return j.concat(n);};_.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof p){return true;}return false;};_.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};_.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};_.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var e1=this._getStandardVariant();if(e1&&e1.filterbar){for(var i=0;i<e1.filterbar.length;i++){if((e1.filterbar[i].group===j.group)&&(e1.filterbar[i].name===j.name)){n=e1.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};_.prototype._addControlToAdvancedArea=function(i,j,n){var e1=new A({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(e1);};_.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};_.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var e1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){e1.push(j);}}}}}}}return e1;};_.prototype._retrieveCurrentSelectionSet=function(j,n){var i,e1,f1,g1=[];var h1=this._retrieveVisibleAdvancedItems();for(i=0;i<h1.length;i++){e1=h1[i];if(e1.control&&e1.filterItem&&(n||!e1.filterItem._isParameter())){if(j){f1={name:h1[i].filterItem.getName(),control:h1[i].control};}else{f1=h1[i].control;}g1.push(f1);}}return g1;};_.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireSearch(i);return true;};_.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};_.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};_.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();if(this._oVariantManagement){var n=this._oVariantManagement.getSelectionKey();if(n){i=this._oVariantManagement.getVariantContent(this,n);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=n;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}this._resetFilterBarSearch();};_.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";if(this._oFiltersSearchField){this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}};_.prototype._applyVariant=function(i,j,n){var e1,f1=null,g1,h1=false;if(i){if(n){g1=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);e1=i.filterBarVariant;f1=i.filterbar;this._ensureFilterLoaded(f1);this._applyVariantFields(e1);this._reapplyVisibility(f1);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){h1=i.executeOnSelection;}this.fireAfterVariantLoad(j,h1);this._setConsiderFilterChanges(true);this._updateToolbarText();if(h1||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(g1);}}};_.prototype._fetchVariantFiltersData=function(){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData();}catch(i){q.sap.log.error("callback for fetching data throws an exception");}}else{q.sap.log.warning("no callback for fetch data supplied");}return null;};_.prototype._applyVariantFields=function(j){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j);}catch(i){q.sap.log.error("callback for applying data throws an exception");}}else{q.sap.log.warning("no callback for appy data supplied");}};_.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};_.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};_.prototype.fetchVariant=function(){var i,j={},n;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V2";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData();n=this._getBasicSearchValue();if(n){j.basicSearch=n;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};_.prototype.applyVariant=function(i,j,n){if(i.version==="V2"){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n);if(n&&this._isNewFilterBarDesign()){}};_.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};_.prototype.determineControlByFilterItem=function(j,e1){var i,n=null;var f1,g1;if(!j||(!e1&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){f1=this._aBasicAreaSelection[i];if(j===f1.filterItem){return f1.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){g1=this._mAdvancedAreaFilter[n];if(g1&&g1.items){for(i=0;i<g1.items.length;i++){f1=g1.items[i];if((e1||!f1.filterItem._isParameter())&&(j===f1.filterItem)){return f1.control;}}}}}}return null;};_.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};_.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};_.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};_.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var e1=j.getGroupName();if(e1!==_.INTERNAL_GROUP){return e1;}}return null;};_.prototype._determineItemByName=function(n,j){var i;var e1,f1;var g1=j;if(!n){return null;}if(!g1){g1=_.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){f1=this._mAdvancedAreaFilter[g1];if(f1&&f1.items){for(i=0;i<f1.items.length;i++){e1=f1.items[i];if(e1&&e1.filterItem&&(e1.filterItem.getName()===n)){return e1;}}}}return null;};_.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};_.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};_.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var e1=this._mAdvancedAreaFilter[n];if(e1&&e1.items){for(i=0;i<e1.items.length;i++){if(e1.items[i]&&e1.items[i].control===j){return e1.items[i];}}}}}}return null;};_.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){j.formcontainer.destroy();delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};_.prototype.onAfterRendering=function(i){if(!this._bDoItOnce&&!(this._isPhone()||this._isTablet())){this._bDoItOnce=true;if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}this._checkAndAdaptFilterWidth();};_.prototype._fHandleResize=function(i){if(!this._isPhone()&&this._oFilterDialog&&this._oFilterDialog.isOpen()&&this._mAdvancedAreaFilter){this._repositionAddToFilterBarLabel();}this._checkAndAdaptFilterWidth();};_.prototype._checkAndAdaptFilterWidth=function(){if(this._isNewFilterBarDesign()&&!this._oFilterDialog){this._adaptFilterWidth();}};_.prototype._adaptFilterWidth=function(){var i;if(!this._oBasicAreaLayout){return;}if(!this._bIsInitialized){return;}var j=this._oBasicAreaLayout.getContent();if(!j){return;}var n=this._isButtonsContainerVisible(this._isPhone()?j[0]:j[j.length-1]);for(i=j.length-1;i>=0;i--){if(!j[i].getVisible()){j.splice(i,1);}}if(j.length<1){return;}var e1=this._oBasicAreaLayout.$().width()-1;var f1,g1=this._calculateRequiredWidthAndResetToInitialWidth(j,n);if(g1>e1){f1=0;}else{f1=j[j.length-1].$().width()+16;}var h1=0,i1=j.length-1;if(n){if(this._isPhone()){h1++;}else{i1--;}}var j1=0;for(i=h1;i<=i1;i++){if((f1+j[i].$().width()+16)>e1){break;}f1+=j[i].$().width()+16;j1++;}var k1=Math.floor((e1-f1)/j1);if((j1===1)&&(g1<e1)){k1=Math.floor(k1/3);}if(k1>0){this._increaseFilterWidth(j,k1,e1,n);}};_.prototype._isButtonsContainerVisible=function(i){var j=false,n,e1;if(i&&i.getVisible()){n=i.getContent();if(n&&(n.length>1)&&n[1]){e1=n[1].getContent();if(e1){e1.some(function(f1){if(f1.getVisible()){j=true;}return j;});}}if(!j){i.setVisible(j);}}return j;};_.prototype._calculateRequiredWidthAndResetToInitialWidth=function(j,n){var i,e1,f1=0;var g1=this._retrieveVisibleAdvancedItems();if(n){if(this._isPhone()){f1=j[0].$().width()+16;}else{f1=j[j.length-1].$().width()+16;}}if(this._oBasicSearchFieldContainer&&this._oBasicSearchFieldContainer.$()){this._oBasicSearchFieldContainer.$().width(this.getFilterContainerWidth());this._oBasicSearchFieldContainer.$().css({"min-width":this.getFilterContainerWidth()});this._oBasicSearchFieldContainer.$().css({"max-width":this._oBasicSearchFieldContainer.$().width()*1.5});f1+=this._oBasicSearchFieldContainer.$().width();f1+=16;}for(i=0;i<g1.length;i++){if(g1[i].filterItem&&g1[i].filterItem.getVisible()&&g1[i].filterItem.getVisibleInFilterBar()){var h1=g1[i].container;if(h1&&h1.$()){if(g1[i].filterWidth){e1=h1.$().width();if(e1!==g1[i].filterWidth){h1.$().width(g1[i].filterWidth);e1=g1[i].filterWidth;}}else{h1.$().width(this.getFilterContainerWidth());e1=h1.$().width();g1[i].filterWidth=e1;}h1.$().css({"min-width":e1});h1.$().css({"max-width":e1*1.5});f1+=e1;f1+=16;}}}return f1;};_.prototype._increaseFilterWidth=function(j,n,e1,f1){var g1,h1=0,i1=j.length-1;if(f1){if(this._isPhone()){h1++;}else{i1--;}}for(var i=h1;i<=i1;i++){g1=j[i].$().width()+n;j[i].$().width(g1);}};_.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};_.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};_.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};_.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};_.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};_.prototype.destroy=function(){sap.ui.core.ResizeHandler.deregister(this._hResizeListener);this._hResizeListener=null;this._unregisterVariantManagement();this._destroyFilterControls();G.prototype.destroy.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oAddToFilterBarLabel=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;};return _;},true);
